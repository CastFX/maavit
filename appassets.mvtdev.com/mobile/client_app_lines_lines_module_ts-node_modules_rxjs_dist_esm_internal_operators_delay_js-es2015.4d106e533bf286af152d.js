"use strict";
(self.webpackChunkmoovit_wtp_next = self.webpackChunkmoovit_wtp_next || []).push([
    ["client_app_lines_lines_module_ts-node_modules_rxjs_dist_esm_internal_operators_delay_js"],
    {
        13517: function (e, i, t) {
            t.r(i),
                t.d(i, {
                    LinesModule: function () {
                        return ki;
                    },
                    lineRouter: function () {
                        return yi;
                    },
                });
            var n = t(54364),
                a = t(43999),
                o = t(3786),
                s = t(73961),
                l = t(75019),
                r = t(2316),
                c = t(94876),
                p = t(95505),
                d = t(36025),
                m = t(99528),
                h = t(21363),
                v = t(7935),
                u = t(99650),
                g = t(15208),
                f = t(61787),
                b = t(87479),
                x = t(93975),
                y = t(53448),
                w = t(99642),
                k = t(2339);
            const S = ["lineInput"];
            function A(e, i) {
                if (1 & e) {
                    const e = r.EpF();
                    r.TgZ(0, "mv-back-button", 9),
                        r.NdJ("backClick", function () {
                            return r.CHM(e), r.oxw().exitSearchDisplay();
                        })("keydown.enter", function () {
                            return r.CHM(e), r.oxw().exitSearchDisplay();
                        }),
                        r.qZA();
                }
                if (2 & e) {
                    const e = r.oxw();
                    r.Q6J("tabIndex", e.tabIndex);
                }
            }
            let Z = (() => {
                class e {
                    constructor(e, i, t, n, a, o, s) {
                        (this.analyticsService = e), (this.splashDisplay = i), (this.searchActions = t), (this.store = n), (this.platformService = a), (this.routingService = o), (this.canonicalService = s), (this.lastSearched = "");
                    }
                    ngOnInit() {
                        const { query: e } = this.routingService.getStateFromUrl();
                        e && ((this.searchInput = e), (this.lastSearched = this.searchInput));
                    }
                    ngOnDestroy() {
                        this.routingService.getStateFromUrl().query && this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath([":tab", ":locale"]), { query: null });
                    }
                    get state() {
                        return this.store.getState();
                    }
                    get tabIndex() {
                        return null === this.state.directions.search.searchInputTypeFocused ? -1 : 0;
                    }
                    onFocus() {
                        this.state.global.splashScreen && this.splashDisplay.invokeDismissal(), this.store.dispatch(this.searchActions.setSearchInputTypeFocused(m.t2.Line));
                    }
                    exitSearchDisplay() {
                        var e;
                        null === (e = this.lineInput.nativeElement) || void 0 === e || e.focus(), window.scrollTo(0, 1), this.store.dispatch(this.searchActions.setSearchInputTypeFocused(null));
                    }
                    search() {
                        this.lastSearched !== this.searchInput && ((this.lastSearched = this.searchInput), this.lineListService.search$.next(this.searchInput), this.analyticsService.trackLinesAction("search line", this.searchInput));
                    }
                    clearSearch() {
                        !this.searchInput || ((this.searchInput = ""), this.lineListService.search$.next(""));
                    }
                    onKeydown(e) {
                        "Escape" === e.key && this.exitSearchDisplay();
                    }
                }
                return (
                    (e.ɵfac = function (i) {
                        return new (i || e)(r.Y36(h.y), r.Y36(v.Y), r.Y36(u.P), r.Y36(d.d), r.Y36(g.mi), r.Y36(p.Z), r.Y36(f.z));
                    }),
                    (e.ɵcmp = r.Xpm({
                        type: e,
                        selectors: [["mv-line-search"]],
                        viewQuery: function (e, i) {
                            if ((1 & e && r.Gf(S, 5), 2 & e)) {
                                let e;
                                r.iGM((e = r.CRH())) && (i.lineInput = e.first);
                            }
                        },
                        hostBindings: function (e, i) {
                            1 & e &&
                                r.NdJ(
                                    "keydown",
                                    function (e) {
                                        return i.onKeydown(e);
                                    },
                                    !1,
                                    r.Jf7
                                );
                        },
                        inputs: { lineListService: "lineListService" },
                        decls: 13,
                        vars: 14,
                        consts: [
                            ["role", "search", 1, "search-zone"],
                            ["class", "gray-fill", 3, "tabIndex", "backClick", "keydown.enter", 4, "ngIf"],
                            [1, "filter-container"],
                            [1, "input-icon"],
                            ["src", "images/icons/search.svg", "mvAccessibleSVG", "", 1, "icon", 3, "titleText"],
                            ["id", "lines-filter", "type", "text", "autocomplete", "off", 1, "lines-filter", 3, "placeholder", "ngModel", "ngModelChange", "focus", "keyup"],
                            ["lineInput", ""],
                            [1, "clear-input", 3, "click"],
                            ["src", "images/icons/close.svg", "mvAccessibleSVG", "", 1, "icon", 3, "titleText"],
                            [1, "gray-fill", 3, "tabIndex", "backClick", "keydown.enter"],
                        ],
                        template: function (e, i) {
                            1 & e &&
                                (r.TgZ(0, "div", 0),
                                r.YNc(1, A, 1, 1, "mv-back-button", 1),
                                r.TgZ(2, "div", 2),
                                r.TgZ(3, "span", 3),
                                r._UZ(4, "svg-icon", 4),
                                r.ALo(5, "translate"),
                                r.qZA(),
                                r.TgZ(6, "input", 5, 6),
                                r.NdJ("ngModelChange", function (e) {
                                    return (i.searchInput = e);
                                })("focus", function () {
                                    return i.onFocus();
                                })("keyup", function () {
                                    return i.search();
                                }),
                                r.ALo(8, "translate"),
                                r.ALo(9, "translate"),
                                r.qZA(),
                                r.TgZ(10, "a", 7),
                                r.NdJ("click", function () {
                                    return i.clearSearch();
                                }),
                                r._UZ(11, "svg-icon", 8),
                                r.ALo(12, "translate"),
                                r.qZA(),
                                r.qZA(),
                                r.qZA()),
                                2 & e &&
                                    (r.xp6(1),
                                    r.Q6J("ngIf", i.platformService.isMobile),
                                    r.xp6(3),
                                    r.s9C("titleText", r.lcZ(5, 6, "action_search")),
                                    r.xp6(2),
                                    r.s9C("placeholder", r.lcZ(8, 8, "line_search_hint")),
                                    r.Q6J("ngModel", i.searchInput),
                                    r.uIk("title", r.lcZ(9, 10, "line_search_hint")),
                                    r.xp6(5),
                                    r.s9C("titleText", r.lcZ(12, 12, "close")));
                        },
                        directives: [n.O5, b.bk, x.m, y.Fj, y.JJ, y.On, w.W],
                        pipes: [k.X$],
                        styles: [
                            '@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}body.mobile mv-root .app-container.lines.lines-main mv-lines-main-view mv-line-search .search-zone mv-back-button{position:absolute;opacity:0;transform:translate(20px);top:3px}html[dir=ltr] body.mobile mv-root .app-container.lines.lines-main mv-lines-main-view mv-line-search .search-zone mv-back-button{left:0}html[dir=rtl] body.mobile mv-root .app-container.lines.lines-main mv-lines-main-view mv-line-search .search-zone mv-back-button{right:0}body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-header{transform:translateY(-4.7058823529rem)}html.privacy-notice body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-header{transform:translateY(-9.4117647059rem)}html.privacy-notice body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-cookie-banner{transition-delay:.1s;transform:translateY(-4.7058823529rem)}body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-line-list cdk-virtual-scroll-viewport{height:calc(100vh - 100px)}body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone{transform:translateY(-4.7058823529rem);height:45px;transition:all ease-in-out .3s}html[dir=ltr] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone{padding:5px 15px 5px 22px}html[dir=rtl] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone{padding:5px 22px 5px 15px}html body.mobile body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone{top:calc(0px + 4.7058823529rem)}html.privacy-notice body.mobile body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone{top:calc(0px + 2.9411764706rem + 4.7058823529rem)}@media only screen and (max-width: 500px){html.privacy-notice body.mobile body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone{top:calc(0px + 4.7058823529rem + 4.7058823529rem)}}html body[data-top-banner=true].mobile:not([class*=c_]) body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone,body[data-top-banner=true].mobile[class*=c_4908] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone,body[data-top-banner=true].mobile[class*=c_4480] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone{top:calc(60px + 4.7058823529rem)}html.privacy-notice body.mobile[data-top-banner=true]:not([class*=c_]) body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone,html.privacy-notice body[data-top-banner=true].mobile[class*=c_4908] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone,html.privacy-notice body[data-top-banner=true].mobile[class*=c_4480] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone{top:calc(60px + 2.9411764706rem + 4.7058823529rem)}@media only screen and (max-width: 500px){html.privacy-notice body.mobile[data-top-banner=true]:not([class*=c_]) body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone,html.privacy-notice body[data-top-banner=true].mobile[class*=c_4908] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone,html.privacy-notice body[data-top-banner=true].mobile[class*=c_4480] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone{top:calc(60px + 4.7058823529rem + 4.7058823529rem)}}html body.mobile.landscape body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone{top:calc(0px + 2.3529411765rem)}html.privacy-notice body.mobile.landscape body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone{top:calc(0px + 2.9411764706rem + 2.3529411765rem)}@media only screen and (max-width: 500px){html.privacy-notice body.mobile.landscape body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone{top:calc(0px + 4.7058823529rem + 2.3529411765rem)}}html body[data-top-banner=true].mobile.landscape:not([class*=c_]) body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone,body[data-top-banner=true].mobile.landscape[class*=c_4908] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone,body[data-top-banner=true].mobile.landscape[class*=c_4480] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone{top:calc(60px + 2.3529411765rem)}html.privacy-notice body.mobile.landscape[data-top-banner=true]:not([class*=c_]) body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone,html.privacy-notice body[data-top-banner=true].mobile.landscape[class*=c_4908] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone,html.privacy-notice body[data-top-banner=true].mobile.landscape[class*=c_4480] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone{top:calc(60px + 2.9411764706rem + 2.3529411765rem)}@media only screen and (max-width: 500px){html.privacy-notice body.mobile.landscape[data-top-banner=true]:not([class*=c_]) body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone,html.privacy-notice body[data-top-banner=true].mobile.landscape[class*=c_4908] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone,html.privacy-notice body[data-top-banner=true].mobile.landscape[class*=c_4480] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone{top:calc(60px + 4.7058823529rem + 2.3529411765rem)}}body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone mv-back-button{opacity:1;transform:translate(0);transition:all .3s ease-in-out .6s}body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone .filter-container{background-color:#fff;height:33px;border-radius:4px;border-bottom:1px solid transparent;transition:all .3s ease-in-out .3s}html[dir=ltr] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone .filter-container{padding:1px 20px 1px 40px}html[dir=rtl] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone .filter-container{padding:1px 40px 1px 20px}html[dir=ltr] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone .filter-container{margin-left:30px}html[dir=rtl] body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone .filter-container{margin-right:30px}body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone .filter-container input{position:relative;height:33px;outline:0;margin:0;color:#292a30;transition:all .3s ease-in-out,color .2s .3s;box-sizing:border-box;padding:5px 8px}body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main mv-lines-main-view mv-line-search .search-zone .filter-container .input-icon{transition:transform .3s ease-in-out;transform:translateY(-.4117647059rem)}body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main .content-container{margin-top:45px;transition:margin-top .3s ease-in-out}html.privacy-notice body.mobile mv-root .app-container.lines.lines-main.search-line-input-focused.lines.lines-main .content-container{margin-top:45px}mv-line-search .search-zone{width:100%;height:81px;z-index:4;background-color:#292a30;padding:34px 20px 20px;box-sizing:border-box;transition:all ease-in-out .3s}mv-line-search .search-zone input:-webkit-autofill,mv-line-search .search-zone input:-webkit-autofill:hover,mv-line-search .search-zone input:-webkit-autofill:focus,mv-line-search .search-zone textarea:-webkit-autofill,mv-line-search .search-zone textarea:-webkit-autofill:hover,mv-line-search .search-zone textarea:-webkit-autofill:focus,mv-line-search .search-zone select:-webkit-autofill,mv-line-search .search-zone select:-webkit-autofill:hover,mv-line-search .search-zone select:-webkit-autofill:focus{-webkit-box-shadow:0 0 0 30px #292A30 inset}html body.mobile mv-line-search .search-zone{top:calc(0px + 4.7058823529rem)}html.privacy-notice body.mobile mv-line-search .search-zone{top:calc(0px + 2.9411764706rem + 4.7058823529rem)}@media only screen and (max-width: 500px){html.privacy-notice body.mobile mv-line-search .search-zone{top:calc(0px + 4.7058823529rem + 4.7058823529rem)}}html body[data-top-banner=true].mobile:not([class*=c_]) mv-line-search .search-zone,body[data-top-banner=true].mobile[class*=c_4908] mv-line-search .search-zone,body[data-top-banner=true].mobile[class*=c_4480] mv-line-search .search-zone{top:calc(60px + 4.7058823529rem)}html.privacy-notice body.mobile[data-top-banner=true]:not([class*=c_]) mv-line-search .search-zone,html.privacy-notice body[data-top-banner=true].mobile[class*=c_4908] mv-line-search .search-zone,html.privacy-notice body[data-top-banner=true].mobile[class*=c_4480] mv-line-search .search-zone{top:calc(60px + 2.9411764706rem + 4.7058823529rem)}@media only screen and (max-width: 500px){html.privacy-notice body.mobile[data-top-banner=true]:not([class*=c_]) mv-line-search .search-zone,html.privacy-notice body[data-top-banner=true].mobile[class*=c_4908] mv-line-search .search-zone,html.privacy-notice body[data-top-banner=true].mobile[class*=c_4480] mv-line-search .search-zone{top:calc(60px + 4.7058823529rem + 4.7058823529rem)}}@media (orientation: landscape) and (min-width: 500px) and (max-height: 599.98px){html body.mobile.landscape mv-line-search .search-zone{top:calc(0px + 2.3529411765rem)}html.privacy-notice body.mobile.landscape mv-line-search .search-zone{top:calc(0px + 2.9411764706rem + 2.3529411765rem)}}@media only screen and (orientation: landscape) and (min-width: 500px) and (max-height: 599.98px) and (max-width: 500px){html.privacy-notice body.mobile.landscape mv-line-search .search-zone{top:calc(0px + 4.7058823529rem + 2.3529411765rem)}}@media (orientation: landscape) and (min-width: 500px) and (max-height: 599.98px){html body[data-top-banner=true].mobile.landscape:not([class*=c_]) mv-line-search .search-zone,body[data-top-banner=true].mobile.landscape[class*=c_4908] mv-line-search .search-zone,body[data-top-banner=true].mobile.landscape[class*=c_4480] mv-line-search .search-zone{top:calc(60px + 2.3529411765rem)}}@media (orientation: landscape) and (min-width: 500px) and (max-height: 599.98px){html.privacy-notice body.mobile.landscape[data-top-banner=true]:not([class*=c_]) mv-line-search .search-zone,html.privacy-notice body[data-top-banner=true].mobile.landscape[class*=c_4908] mv-line-search .search-zone,html.privacy-notice body[data-top-banner=true].mobile.landscape[class*=c_4480] mv-line-search .search-zone{top:calc(60px + 2.9411764706rem + 2.3529411765rem)}}@media only screen and (orientation: landscape) and (min-width: 500px) and (max-height: 599.98px) and (max-width: 500px){html.privacy-notice body.mobile.landscape[data-top-banner=true]:not([class*=c_]) mv-line-search .search-zone,html.privacy-notice body[data-top-banner=true].mobile.landscape[class*=c_4908] mv-line-search .search-zone,html.privacy-notice body[data-top-banner=true].mobile.landscape[class*=c_4480] mv-line-search .search-zone{top:calc(60px + 4.7058823529rem + 2.3529411765rem)}}body.mobile mv-line-search .search-zone{position:fixed}body.desktop mv-line-search .search-zone{position:relative}@media screen and (min-width: 500px){body.mobile.landscape mv-line-search .search-zone{padding:15px 20px 20px;height:60px}html body.mobile.landscape body.mobile.landscape mv-line-search .search-zone{top:calc(0px + 6rem)}html.privacy-notice body.mobile.landscape body.mobile.landscape mv-line-search .search-zone{top:calc(0px + 2.9411764706rem + 6rem)}}@media only screen and (min-width: 500px) and (max-width: 500px){html.privacy-notice body.mobile.landscape body.mobile.landscape mv-line-search .search-zone{top:calc(0px + 4.7058823529rem + 6rem)}}@media screen and (min-width: 500px){html body[data-top-banner=true].mobile.landscape:not([class*=c_]) body.mobile.landscape mv-line-search .search-zone,body[data-top-banner=true].mobile.landscape[class*=c_4908] body.mobile.landscape mv-line-search .search-zone,body[data-top-banner=true].mobile.landscape[class*=c_4480] body.mobile.landscape mv-line-search .search-zone{top:calc(60px + 6rem)}}@media screen and (min-width: 500px){html.privacy-notice body.mobile.landscape[data-top-banner=true]:not([class*=c_]) body.mobile.landscape mv-line-search .search-zone,html.privacy-notice body[data-top-banner=true].mobile.landscape[class*=c_4908] body.mobile.landscape mv-line-search .search-zone,html.privacy-notice body[data-top-banner=true].mobile.landscape[class*=c_4480] body.mobile.landscape mv-line-search .search-zone{top:calc(60px + 2.9411764706rem + 6rem)}}@media only screen and (min-width: 500px) and (max-width: 500px){html.privacy-notice body.mobile.landscape[data-top-banner=true]:not([class*=c_]) body.mobile.landscape mv-line-search .search-zone,html.privacy-notice body[data-top-banner=true].mobile.landscape[class*=c_4908] body.mobile.landscape mv-line-search .search-zone,html.privacy-notice body[data-top-banner=true].mobile.landscape[class*=c_4480] body.mobile.landscape mv-line-search .search-zone{top:calc(60px + 4.7058823529rem + 6rem)}}mv-line-search .search-zone:after{bottom:0;box-shadow:0 2px 3px -1px #0000004d;content:"";display:block;height:10px;left:0;position:absolute;width:100%;z-index:9}mv-line-search .search-zone .filter-container{border-bottom:1px solid #525357;position:relative}html[dir=ltr] mv-line-search .search-zone .filter-container{padding-right:26px}html[dir=rtl] mv-line-search .search-zone .filter-container{padding-left:26px}html[dir=ltr] mv-line-search .search-zone .filter-container{padding-left:36px}html[dir=rtl] mv-line-search .search-zone .filter-container{padding-right:36px}mv-line-search .search-zone .filter-container:hover .clear-input{opacity:1}mv-line-search .search-zone .filter-container .input-icon{position:absolute;top:calc(50% - 1px);transform:translateY(-50%)}html[dir=ltr] mv-line-search .search-zone .filter-container .input-icon{left:9px}html[dir=rtl] mv-line-search .search-zone .filter-container .input-icon{right:9px}mv-line-search .search-zone .filter-container .input-icon .icon{height:16px;width:16px}mv-line-search .search-zone .filter-container .input-icon .icon .cls-1{fill:#bdc3c7}mv-line-search .search-zone .filter-container input{background:none;border:none;color:#292a30;color:#fff;height:24px;line-height:24px;font-size:.9411764706rem}mv-line-search .search-zone .filter-container input:focus{outline:none;width:200px;transition:all .3s}mv-line-search .search-zone .filter-container input::-moz-placeholder{color:#929191}mv-line-search .search-zone .filter-container input::placeholder{color:#929191}mv-line-search .search-zone .filter-container .clear-input{cursor:pointer;opacity:0;position:absolute;transform:translateY(-50%);transition:opacity .3s;top:50%}html[dir=ltr] mv-line-search .search-zone .filter-container .clear-input{right:6px}html[dir=rtl] mv-line-search .search-zone .filter-container .clear-input{left:6px}mv-line-search .search-zone .filter-container .clear-input .icon{color:#bdc3c7;height:.4705882353rem;width:.4705882353rem}\n',
                        ],
                        encapsulation: 2,
                    })),
                    e
                );
            })();
            var _ = t(50709),
                T = t(30977),
                I = t(5306),
                z = t(79223);
            function q(e, i) {
                1 & e && (r.TgZ(0, "div", 4), r._UZ(1, "svg-icon", 5), r.ALo(2, "translate"), r.TgZ(3, "div", 6), r._uU(4), r.ALo(5, "translate"), r.qZA(), r.qZA()),
                    2 & e && (r.xp6(1), r.s9C("titleText", r.lcZ(2, 2, "NoTripPlanFoundTitle")), r.xp6(3), r.Oqu(r.lcZ(5, 4, "line_no_results")));
            }
            function N(e, i) {
                if ((1 & e && (r.TgZ(0, "div", 9), r.TgZ(1, "span", 10), r._uU(2), r.qZA(), r.TgZ(3, "span", 11), r._uU(4), r.ALo(5, "translate"), r.qZA(), r.qZA()), 2 & e)) {
                    const e = r.oxw().item;
                    r.uIk("aria-labelledby", "agency-title-" + e.agencyName), r.xp6(2), r.Oqu(e.agencyName), r.xp6(2), r.Oqu(r.lcZ(5, 3, e.agencyType));
                }
            }
            function O(e, i) {
                if ((1 & e && (r._UZ(0, "div", 17), r.ALo(1, "safeHtml"), r.ALo(2, "async")), 2 & e)) {
                    const e = r.oxw(2).item;
                    r.Q6J("innerHTML", r.lcZ(1, 1, r.lcZ(2, 3, e.imageHtml)), r.oJD);
                }
            }
            function Y(e, i) {
                if ((1 & e && (r.TgZ(0, "span", 18), r._uU(1), r.qZA()), 2 & e)) {
                    const e = r.oxw(2).item;
                    r.xp6(1), r.Oqu(e.lineName.secondary);
                }
            }
            function C(e, i) {
                if ((1 & e && (r.TgZ(0, "div", 12), r.YNc(1, O, 3, 5, "div", 13), r.ALo(2, "async"), r.TgZ(3, "div", 14), r.TgZ(4, "span", 15), r._uU(5), r.qZA(), r.YNc(6, Y, 2, 1, "span", 16), r.qZA(), r.qZA()), 2 & e)) {
                    const e = r.oxw().item;
                    r.xp6(1), r.Q6J("ngIf", r.lcZ(2, 5, e.imageHtml)), r.xp6(3), r.ekj("primary", e.lineName.secondary), r.xp6(1), r.Oqu(e.lineName.primary), r.xp6(1), r.Q6J("ngIf", e.lineName.secondary);
                }
            }
            function M(e, i) {
                if ((1 & e && (r.YNc(0, N, 6, 5, "div", 7), r.YNc(1, C, 7, 7, "div", 8)), 2 & e)) {
                    const e = i.item,
                        t = r.oxw();
                    r.Q6J("ngIf", e.$type === t.LineListItemType.AGENCY), r.xp6(1), r.Q6J("ngIf", e.$type === t.LineListItemType.LINE);
                }
            }
            function D(e, i) {
                1 & e && r.GkF(0);
            }
            const J = function (e) {
                return { item: e };
            };
            function E(e, i) {
                if (1 & e) {
                    const e = r.EpF();
                    r.TgZ(0, "div", 22),
                        r.NdJ("keydown", function (i) {
                            const t = r.CHM(e).index;
                            return r.oxw(2).onKeydown(i, t);
                        })("click", function () {
                            const i = r.CHM(e).$implicit;
                            return r.oxw(2).onItemClick(i);
                        }),
                        r.YNc(1, D, 1, 0, "ng-container", 23),
                        r.qZA();
                }
                if (2 & e) {
                    const e = i.$implicit,
                        t = i.index;
                    r.oxw(2);
                    const n = r.MAs(2);
                    r.Q6J("id", "line_" + t)("tabIndex", 1 === t ? 0 : -1), r.xp6(1), r.Q6J("ngTemplateOutlet", n)("ngTemplateOutletContext", r.VKq(4, J, e));
                }
            }
            function F(e, i) {
                if (1 & e) {
                    const e = r.EpF();
                    r.TgZ(0, "cdk-virtual-scroll-viewport", 19),
                        r.NdJ("scrolledIndexChange", function () {
                            return r.CHM(e), r.oxw().onScroll();
                        }),
                        r.TgZ(1, "div", 20),
                        r.YNc(2, E, 2, 6, "div", 21),
                        r.qZA(),
                        r.qZA();
                }
                if (2 & e) {
                    const e = r.oxw();
                    r.xp6(2), r.Q6J("cdkVirtualForOf", e.lineListService.list$);
                }
            }
            function Q(e, i) {
                1 & e && r.GkF(0);
            }
            function U(e, i) {
                if (1 & e) {
                    const e = r.EpF();
                    r.TgZ(0, "div", 25),
                        r.NdJ("click", function () {
                            const i = r.CHM(e).$implicit;
                            return r.oxw(2).onItemClick(i);
                        }),
                        r.YNc(1, Q, 1, 0, "ng-container", 23),
                        r.qZA();
                }
                if (2 & e) {
                    const e = i.$implicit;
                    r.oxw(2);
                    const t = r.MAs(2);
                    r.xp6(1), r.Q6J("ngTemplateOutlet", t)("ngTemplateOutletContext", r.VKq(2, J, e));
                }
            }
            function R(e, i) {
                if ((1 & e && (r.TgZ(0, "div", 20), r.YNc(1, U, 2, 4, "div", 24), r.ALo(2, "async"), r.qZA()), 2 & e)) {
                    const e = r.oxw();
                    r.xp6(1), r.Q6J("ngForOf", r.lcZ(2, 1, e.lineListService.list$));
                }
            }
            let G = (() => {
                class e {
                    constructor(e, i, t, n, a, o, s) {
                        (this.routingService = e),
                            (this.store = i),
                            (this.lineActions = t),
                            (this.analyticsService = n),
                            (this.canonicalService = a),
                            (this.universal = o),
                            (this.document = s),
                            (this.LineListItemType = T.G),
                            (this.deepestOffset = 0);
                    }
                    get state() {
                        return this.store.getState();
                    }
                    get emptyState() {
                        return this.lineListService.isInitiated && !this.state.global.isLoading && !this.state.line.items.length;
                    }
                    ngOnInit() {
                        return (0, o.mG)(this, void 0, void 0, function* () {
                            this.lineListService.searchEvent.subscribe(() => (this.deepestOffset = 0));
                        });
                    }
                    onItemClick(e) {
                        return (0, o.mG)(this, void 0, void 0, function* () {
                            e.$type === T.G.LINE && (yield this.store.dispatch(this.lineActions.loadLineGroup(e.lineGroupId)), this.analyticsService.trackLinesAction("line group selected", e.lineName));
                        });
                    }
                    onScroll() {
                        const e = this.document.getElementById("lines-filter");
                        if ((e && e.blur(), this.lineListService.infFinished)) return;
                        const i = this.viewport.getRenderedRange().end;
                        i === this.viewport.getDataLength() && this.deepestOffset < i && ((this.deepestOffset = i), this.lineListService.next(null, "scroll"));
                    }
                    onKeydown(e, i) {
                        if ("ArrowUp" === e.key && i - 1 >= 0) e.preventDefault(), this.updateSelection(i, -1);
                        else if ("ArrowDown" === e.key && i + 1 < this.lineListService.list$.getValue().length) e.preventDefault(), this.updateSelection(i, 1);
                        else if ("Enter" === e.key) {
                            e.preventDefault();
                            const t = this.lineListService.list$.getValue()[i];
                            this.onItemClick(t);
                        }
                    }
                    updateSelection(e, i) {
                        let t = e + i;
                        this.lineListService.list$.getValue()[t].$type !== T.G.LINE && (t = e + i + (-1 === Math.sign(i) ? -1 : 1)), this.setSelectedFocus(t);
                    }
                    setSelectedFocus(e) {
                        const i = this.document.getElementById(`line_${e}`);
                        i && (i.focus(), i.scrollIntoView({ block: "center" }));
                    }
                }
                return (
                    (e.ɵfac = function (i) {
                        return new (i || e)(r.Y36(p.Z), r.Y36(d.d), r.Y36(c.J), r.Y36(h.y), r.Y36(f.z), r.Y36(I.p), r.Y36(n.K0));
                    }),
                    (e.ɵcmp = r.Xpm({
                        type: e,
                        selectors: [["mv-line-list"]],
                        viewQuery: function (e, i) {
                            if ((1 & e && r.Gf(_.N7, 5), 2 & e)) {
                                let e;
                                r.iGM((e = r.CRH())) && (i.viewport = e.first);
                            }
                        },
                        inputs: { lineListService: "lineListService" },
                        decls: 5,
                        vars: 3,
                        consts: [
                            ["class", "empty-results", "role", "status", 4, "ngIf"],
                            ["lineRow", ""],
                            ["itemSize", "77", 3, "scrolledIndexChange", 4, "ngIf"],
                            ["class", "results-wrapper", 4, "ngIf"],
                            ["role", "status", 1, "empty-results"],
                            ["src", "images/error-states/img_empty_state_omni.svg", "mvAccessibleSVG", "", 1, "icon", 3, "titleText"],
                            [1, "message"],
                            ["class", "agency-header", "role", "group", 4, "ngIf"],
                            ["class", "line-item", "role", "listitem", 4, "ngIf"],
                            ["role", "group", 1, "agency-header"],
                            [1, "name"],
                            [1, "type"],
                            ["role", "listitem", 1, "line-item"],
                            ["class", "line-image", 3, "innerHTML", 4, "ngIf"],
                            [1, "line-title-wrapper", "flex-col"],
                            [1, "line-title"],
                            ["class", "line-detail", 4, "ngIf"],
                            [1, "line-image", 3, "innerHTML"],
                            [1, "line-detail"],
                            ["itemSize", "77", 3, "scrolledIndexChange"],
                            [1, "results-wrapper"],
                            ["class", "line-row", 3, "id", "tabIndex", "keydown", "click", 4, "cdkVirtualFor", "cdkVirtualForOf"],
                            [1, "line-row", 3, "id", "tabIndex", "keydown", "click"],
                            [4, "ngTemplateOutlet", "ngTemplateOutletContext"],
                            ["class", "line-row", 3, "click", 4, "ngFor", "ngForOf"],
                            [1, "line-row", 3, "click"],
                        ],
                        template: function (e, i) {
                            1 & e && (r.YNc(0, q, 6, 6, "div", 0), r.YNc(1, M, 2, 2, "ng-template", null, 1, r.W1O), r.YNc(3, F, 3, 1, "cdk-virtual-scroll-viewport", 2), r.YNc(4, R, 3, 3, "div", 3)),
                                2 & e && (r.Q6J("ngIf", i.emptyState), r.xp6(3), r.Q6J("ngIf", i.universal.isBrowser), r.xp6(1), r.Q6J("ngIf", i.universal.isServer));
                        },
                        directives: [n.O5, b.bk, x.m, _.N7, _.xd, _.x0, n.tP, n.sg],
                        pipes: [k.X$, n.Ov, z.z],
                        styles: [
                            '@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-line-list .empty-results .icon{fill:#bdc3c7;display:block;height:32px;margin:26px auto 0;width:32px}mv-line-list .empty-results .message{font-size:.9411764706rem;color:#737578;margin:14px 0;text-align:center;padding:20px}mv-line-list cdk-virtual-scroll-viewport{width:100%;height:100%}body.mobile mv-line-list cdk-virtual-scroll-viewport{position:fixed;height:calc(100vh - 40px);left:0}@media screen and (max-height: 374px){body.mobile mv-line-list cdk-virtual-scroll-viewport{height:calc(100vh - 220px);bottom:0}}@media screen and (min-width: 500px){body.mobile mv-line-list cdk-virtual-scroll-viewport{height:calc(100vh - 160px)}}mv-line-list cdk-virtual-scroll-viewport li{height:20px}mv-line-list cdk-virtual-scroll-viewport .cdk-virtual-scroll-content-wrapper{width:100%}body.desktop mv-line-list cdk-virtual-scroll-viewport .cdk-virtual-scroll-content-wrapper{position:static}mv-line-list .results-wrapper{background-color:#fff;box-sizing:border-box;overflow:hidden;-webkit-overflow-scrolling:touch;padding:0;position:relative;z-index:0}mv-line-list .results-wrapper>.line-row{width:100%;min-height:39px}mv-line-list .results-wrapper>.line-row:focus{outline:#302E2E auto 1px}mv-line-list .results-wrapper>.line-row:hover{outline:none}mv-line-list .results-wrapper>.line-row .agency-header{background-color:#ecf0f1;box-sizing:border-box;color:#6c6d6d;display:table;line-height:1.4;margin-top:-1px;padding:14px 20px 6px;width:100%;z-index:1}mv-line-list .results-wrapper>.line-row .agency-header .name,mv-line-list .results-wrapper>.line-row .agency-header .type{display:table-cell;vertical-align:middle;width:1px;font-size:.8235294118rem}mv-line-list .results-wrapper>.line-row .agency-header .name{width:100%}mv-line-list .results-wrapper>.line-row .agency-header .type{white-space:nowrap}html[dir=ltr] mv-line-list .results-wrapper>.line-row .agency-header .type{padding-left:20px}html[dir=rtl] mv-line-list .results-wrapper>.line-row .agency-header .type{padding-right:20px}mv-line-list .results-wrapper>.line-row .line-item:after{background:#DDDDDD;content:"";display:block;height:1px;position:absolute;bottom:0;left:20px;width:calc(100% - 40px);z-index:-1}\n',
                        ],
                        encapsulation: 2,
                    })),
                    e
                );
            })();
            function B(e, i) {
                if ((1 & e && r._UZ(0, "mv-line-list", 0), 2 & e)) {
                    const e = r.oxw();
                    r.Q6J("lineListService", e.lineListService);
                }
            }
            let H = (() => {
                class e {
                    constructor(e, i, t, n) {
                        (this.lineListService = e), (this.lineActions = i), (this.routingService = t), (this.store = n);
                    }
                    ngOnInit() {
                        return (0, o.mG)(this, void 0, void 0, function* () {
                            this.store.dispatch(this.lineActions.clearDisplayedLine()), yield (0, l.p5)(this.store);
                            const { query: e } = this.routingService.getStateFromUrl();
                            yield this.lineListService.init(e);
                        });
                    }
                    get appIsReady() {
                        return this.store.getState().global.appIsReady;
                    }
                }
                return (
                    (e.ɵfac = function (i) {
                        return new (i || e)(r.Y36(s.le), r.Y36(c.J), r.Y36(p.Z), r.Y36(d.d));
                    }),
                    (e.ɵcmp = r.Xpm({
                        type: e,
                        selectors: [["mv-lines-main-view"]],
                        features: [r._Bn([s.le])],
                        decls: 2,
                        vars: 2,
                        consts: [
                            [3, "lineListService"],
                            [3, "lineListService", 4, "ngIf"],
                        ],
                        template: function (e, i) {
                            1 & e && (r._UZ(0, "mv-line-search", 0), r.YNc(1, B, 1, 1, "mv-line-list", 1)), 2 & e && (r.Q6J("lineListService", i.lineListService), r.xp6(1), r.Q6J("ngIf", i.appIsReady));
                        },
                        directives: [Z, n.O5, G],
                        styles: [
                            "@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-lines-main-view{overflow-y:auto;height:calc(100vh - 80px)}\n",
                        ],
                        encapsulation: 2,
                    })),
                    e
                );
            })();
            var $ = t(42118),
                P = t(16438),
                V = t(13127),
                j = t(44143),
                K = t(8967),
                X = t(85431),
                W = t(88403),
                ee = t(23137);
            let ie = (() => {
                class e extends K.d {
                    constructor(e, i, t, n, a) {
                        super(i, t, n, "linesMapElement", "ItineraryMap"), (this.storeHelper = e), (this.store = i), (this.customerService = t), (this.uiActions = n), (this.lineActions = a), (this.unsubscribes = []);
                    }
                    ngOnInit() {
                        return (0, o.mG)(this, void 0, void 0, function* () {
                            yield this.initLeafletMap(),
                                this.drawLine(),
                                this.unsubscribes.push(
                                    this.storeHelper.subscribe("line.linesMapHasNewData", (e) => {
                                        e && (this.drawLine(), this.store.dispatch(this.lineActions.readMapData()));
                                    })
                                );
                        });
                    }
                    ngOnDestroy() {
                        this.unsubscribes.forEach((e) => e()), this.map && (this.map.remove(), (this.map = null));
                    }
                    get state() {
                        return this.store.getState();
                    }
                    get selectedRoute() {
                        return this.state.itinerary.selectedRoute;
                    }
                    get selectedStep() {
                        return this.state.itinerary.navSelectedStep;
                    }
                    drawLine() {
                        if (!this.state.line.lineGroup || !this.state.line.displayedLine) return;
                        const e = this.state.line.lineGroup.color,
                            i = `#${e}`,
                            t = this.state.line.displayedLine.shape,
                            n = this.state.line.displayedLine.stops;
                        if ((this.logger.log("onLineDisplay", { color: e, shape: t, stops: n }), this.removeLinePolyline(), !t || !t.encodedShape)) return;
                        const a = new Date();
                        this.logger.log("drawRoute BEFORE");
                        const o = j.Ry(t.encodedShape);
                        if (o && o.length > 0) {
                            (this.pathShadow = L.polyline(o).addTo(this.map)),
                                (this.pathHighlight = L.polyline(o).addTo(this.map)),
                                (this.pathRoute = L.polyline(o).addTo(this.map)),
                                this.pathShadow.setStyle({ color: "#383838", weight: 10, opacity: 1 }),
                                this.pathHighlight.setStyle({ color: "#fafafa", weight: 8, opacity: 1 }),
                                this.pathRoute.setStyle({ color: i, weight: 3, opacity: 1 });
                            const e = n.map((e) => {
                                const i = V._.fromMvLatLon(e.location);
                                return (i.stopName = e.name), i;
                            });
                            this.createStopMarkers(i, e, o, !1, !1), this.fitBoundsByPoints(o);
                        } else this.removeLinePolyline();
                        const s = new Date();
                        this.logger.log("drawRoute AFTER:" + (s.valueOf() - a.valueOf()));
                    }
                    removeLinePolyline() {
                        this.linePolyline && (this.map.removeLayer(this.linePolyline), (this.linePolyline = null));
                    }
                }
                return (
                    (e.ɵfac = function (i) {
                        return new (i || e)(r.Y36(X.N), r.Y36(d.d), r.Y36(W.v), r.Y36(ee.V), r.Y36(c.J));
                    }),
                    (e.ɵcmp = r.Xpm({
                        type: e,
                        selectors: [["mv-lines-map"]],
                        features: [r.qOj],
                        decls: 1,
                        vars: 0,
                        consts: [["id", "linesMapElement", 1, "lines-map"]],
                        template: function (e, i) {
                            1 & e && r._UZ(0, "div", 0);
                        },
                        styles: [
                            "@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-lines-map{position:absolute;width:100%;height:100%}mv-lines-map .lines-map{width:100%;height:100%}mv-lines-map .lines-map .stop-div-icon div{background-color:#edeff3;border:1px solid #292A30;border-radius:50%;box-sizing:border-box;height:100%;width:100%;box-shadow:0 0 3px 1px #000}\n",
                        ],
                        encapsulation: 2,
                    })),
                    e
                );
            })();
            function te(e, i) {
                1 & e && r._UZ(0, "mv-lines-map");
            }
            let ne = (() => {
                class e {
                    constructor(e) {
                        this.store = e;
                    }
                    get isMetroReady() {
                        return !!this.store.getState().metro.currentMetro;
                    }
                }
                return (
                    (e.ɵfac = function (i) {
                        return new (i || e)(r.Y36(d.d));
                    }),
                    (e.ɵcmp = r.Xpm({
                        type: e,
                        selectors: [["mv-lines-map-view"]],
                        decls: 1,
                        vars: 1,
                        consts: [[4, "ngIf"]],
                        template: function (e, i) {
                            1 & e && r.YNc(0, te, 1, 0, "mv-lines-map", 0), 2 & e && r.Q6J("ngIf", i.isMetroReady);
                        },
                        directives: [n.O5, ie],
                        styles: ["mv-lines-map-view{position:absolute;top:0;bottom:0;right:0;left:0;width:100%;height:100%;overflow:hidden;z-index:0}\n"],
                        encapsulation: 2,
                    })),
                    e
                );
            })();
            var ae = t(43049),
                oe = t(26351),
                se = t(64852),
                le = t(80221),
                re = t(97192),
                ce = t(1210),
                pe = t(85501),
                de = t(35533),
                me = t(98922),
                he = t(51611),
                ve = t(19073),
                ue = t(2281),
                ge = t(65492),
                fe = t(49331);
            let be = (() => {
                class e {
                    constructor(e, i, t) {
                        (this.httpService = e), (this.translate = i), (this.store = t), (this.realTime$ = new de.w0());
                    }
                    get state() {
                        return this.store.getState();
                    }
                    terminateRealTime() {
                        (this.realTimeResult = ""), this.realTime$.unsubscribe();
                    }
                    runRealTime(e, i) {
                        this.terminateRealTime(),
                            (this.realTime$ = (0, me.F)(1e4)
                                .pipe(
                                    (0, he.O)(0),
                                    (0, ve.z)(() => this.getLineArrivalsToStop(e, i))
                                )
                                .subscribe((e) => {
                                  debugger;
                                    if (e.length > 0) {
                                        let i;
                                        if (this.state.line.selectedSubgroup)
                                            i = [].concat.apply(
                                                [],
                                                e.map((e) => e.lineArrivals.arrivals)
                                            );
                                        else {
                                            const t = e.find((e) => e.lineArrivals.lineId === this.state.line.selectedLine.lineId);
                                            (i = t ? t.lineArrivals.arrivals : null),
                                                (null == i ? void 0 : i.length) > 0 && this.state.line.displayedLine.patternId && (i = i.filter((e) => e.patternId === this.state.line.displayedLine.patternId));
                                        }
                                        if ((null == i ? void 0 : i.length) > 0) {
                                            const t = i[0].relativeRealTimeSpanSeconds,
                                                n = this.state.metro.currentMetro.timeZoneOffset,
                                                a = ue().utcOffset(n).diff(ue().utcOffset(n).startOf("day"), "seconds"),
                                                o = (0, oe.Ic)(e[0].epochDay),
                                                s = Math.floor((t - (a + o)) / 60);
                                            s > -1 ? (this.realTimeResult = 0 == s ? this.translate.instant("now") : this.translate.instant("units_minutes_text", { param1: s })) : this.terminateRealTime();
                                        }
                                    }
                                }));
                    }
                    getLineArrivalsToStop(e, i) {
                        console.log(e, i);
                        ;
                        return this.httpService.post(ge.bl.GetLineArrival, { body: { stopId: e, lineIds: JSON.stringify({ ids: i }) } }, !0);
                    }
                    hasStopArrivals(e, i, t) {
                        return this.getStopArrivalTime(i, e, t);
                    }
                    getStopArrival(e, i, t) {
                        const n = this.getStopArrivalTime(i, e, t);
                        return n ? this.formatDepartureTime(n.arrivalTime) : null;
                    }
                    formatDepartureTime(e) {
                        return (0, oe.mr)(ue.unix(e));
                    }
                    getNextArrivals(e, i) {
                        const t = this.getStopArrival(e, 1, i),
                            n = this.getStopArrival(e, 2, i);
                        return `${t}${n ? `, ${n}` : ""}`;
                    }
                    getDepartureDate() {
                        if (!this.state.line.displayedLine) return null;
                        let e = null;
                        for (let i = 0; i < this.state.line.displayedLine.stops.length && ((e = this.state.line.displayedLine.stopArrivals[this.state.line.displayedLine.stops[i].id]), !e); i++);
                        return e ? ue.unix(e[0].arrivalTime).calendar() : null;
                    }
                    getStopArrivalTime(e, i, t) {
                        const n = this.state.line.displayedLine.stopArrivals[i.id].filter((e) => e.stopIndex === t);
                        if (n) {
                            const i = ue().unix();
                            let t = -1,
                                a = n.find((e, n) => e.arrivalTime > i && ((t = n), !0));
                            if (a) return (a = n[t + e]), a;
                        }
                        return null;
                    }
                }
                return (
                    (e.ɵfac = function (i) {
                        return new (i || e)(r.LFG(fe.O), r.LFG(k.sK), r.LFG(d.d));
                    }),
                    (e.ɵprov = r.Yz7({ token: e, factory: e.ɵfac, providedIn: "root" })),
                    e
                );
            })();
            var xe = t(78146),
                ye = t(21532),
                we = t(31251),
                ke = t(19581),
                Se = t(31127),
                Le = t(89458);
            const Ae = ["backButton"];
            function Ze(e, i) {
                if ((1 & e && (r.TgZ(0, "div", 22), r._uU(1), r.qZA()), 2 & e)) {
                    const e = r.oxw(2);
                    r.xp6(1), r.hij(" ", e.lineRealTimeService.getDepartureDate(), " ");
                }
            }
            function _e(e, i) {
                if ((1 & e && (r.TgZ(0, "div", 23), r._uU(1), r.qZA()), 2 & e)) {
                    const e = r.oxw(2);
                    r.xp6(1), r.Oqu(e.title);
                }
            }
            function Te(e, i) {
                if ((1 & e && (r.TgZ(0, "div", 24), r._uU(1), r.qZA()), 2 & e)) {
                    const e = r.oxw(2);
                    r.xp6(1), r.Oqu(e.subTitle);
                }
            }
            function Ie(e, i) {
                1 & e && r._UZ(0, "mv-share", 25), 2 & e && r.Q6J("showCaption", !1);
            }
            function ze(e, i) {
                if (1 & e) {
                    const e = r.EpF();
                    r.TgZ(0, "div", 26),
                        r.NdJ("click", function () {
                            return r.CHM(e), r.oxw(2).onAlertClick();
                        })("keydown.enter", function () {
                            return r.CHM(e), r.oxw(2).onAlertClick();
                        }),
                        r._uU(1),
                        r.qZA();
                }
                if (2 & e) {
                    const e = r.oxw(2);
                    r.xp6(1), r.hij(" ", e.state.line.lineAlert.serviceAlertEffect, " ");
                }
            }
            function qe(e, i) {
                if ((1 & e && (r.TgZ(0, "div", 27), r.TgZ(1, "div"), r.TgZ(2, "span", 28), r._uU(3), r.qZA(), r.qZA(), r.qZA()), 2 & e)) {
                    const e = r.oxw(2);
                    r.xp6(3), r.Oqu(e.getLineTitle(e.state.line.selectedLine));
                }
            }
            function Ne(e, i) {
                if ((1 & e && (r.TgZ(0, "option", 36), r._uU(1), r.qZA()), 2 & e)) {
                    const e = i.$implicit,
                        t = r.oxw(4);
                    r.Q6J("ngValue", e), r.xp6(1), r.hij(" ", t.getLineTitle(e), " ");
                }
            }
            function Oe(e, i) {
                if (1 & e) {
                    const e = r.EpF();
                    r.ynx(0),
                        r.TgZ(1, "select", 34),
                        r.NdJ("ngModelChange", function (i) {
                            return r.CHM(e), r.oxw(3).onLineChange(i);
                        }),
                        r.ALo(2, "translate"),
                        r.YNc(3, Ne, 2, 2, "option", 35),
                        r.qZA(),
                        r.BQk();
                }
                if (2 & e) {
                    const e = r.oxw(3);
                    r.xp6(1), r.Q6J("ngModel", e.selectedLineOption), r.uIk("aria-label", r.lcZ(2, 3, "line_change_direction")), r.xp6(2), r.Q6J("ngForOf", e.state.line.lineDirections);
                }
            }
            function Ye(e, i) {
                if (1 & e) {
                    const e = r.EpF();
                    r.TgZ(0, "button", 41),
                        r.NdJ("click", function () {
                            const i = r.CHM(e).$implicit;
                            return r.oxw(4).onLineChange(i);
                        }),
                        r._uU(1),
                        r.qZA();
                }
                if (2 & e) {
                    const e = i.$implicit,
                        t = r.oxw(4);
                    r.xp6(1), r.hij(" ", t.getLineTitle(e), " ");
                }
            }
            function Ce(e, i) {
                if ((1 & e && (r._UZ(0, "button", 37), r.TgZ(1, "mat-menu", 38, 39), r.ALo(3, "translate"), r.YNc(4, Ye, 2, 1, "button", 40), r.qZA()), 2 & e)) {
                    const e = r.MAs(2),
                        i = r.oxw(3);
                    r.Q6J("matMenuTriggerFor", e), r.xp6(1), r.uIk("aria-label", r.lcZ(3, 3, "line_change_direction")), r.xp6(3), r.Q6J("ngForOf", i.state.line.lineDirections);
                }
            }
            function Me(e, i) {
                if (
                    (1 & e &&
                        (r.TgZ(0, "div", 29),
                        r.YNc(1, Oe, 4, 5, "ng-container", 30),
                        r.YNc(2, Ce, 5, 5, "ng-template", null, 31, r.W1O),
                        r.TgZ(4, "span", 32),
                        r._uU(5),
                        r.ALo(6, "translate"),
                        r._UZ(7, "svg-icon", 33),
                        r.ALo(8, "translate"),
                        r.qZA(),
                        r.qZA()),
                    2 & e)
                ) {
                    const e = r.MAs(3),
                        i = r.oxw(2);
                    r.xp6(1), r.Q6J("ngIf", i.platformService.isMobile)("ngIfElse", e), r.xp6(4), r.hij("", r.lcZ(6, 4, "line_change_direction"), " "), r.xp6(2), r.s9C("titleText", r.lcZ(8, 6, "line_change_direction"));
                }
            }
            function De(e, i) {
                if (1 & e) {
                    const e = r.EpF();
                    r.TgZ(0, "span", 50),
                        r.NdJ("click", function () {
                            const i = r.CHM(e).index;
                            return r.oxw(3).onLineOptionChange(i);
                        }),
                        r.qZA();
                }
                if (2 & e) {
                    const e = i.index,
                        t = r.oxw(3);
                    r.ekj("selected", t.state.line.selectedLineOptionIndex === e);
                }
            }
            function Je(e, i) {
                if (1 & e) {
                    const e = r.EpF();
                    r.TgZ(0, "div", 42),
                        r.TgZ(1, "div", 43),
                        r.TgZ(2, "a", 44),
                        r.NdJ("click", function () {
                            r.CHM(e);
                            const i = r.oxw(2);
                            return i.onLineOptionChange(i.state.line.selectedLineOptionIndex - 1);
                        }),
                        r._UZ(3, "svg-icon", 45),
                        r.ALo(4, "translate"),
                        r.qZA(),
                        r.TgZ(5, "a", 46),
                        r.NdJ("click", function () {
                            r.CHM(e);
                            const i = r.oxw(2);
                            return i.onLineOptionChange(i.state.line.selectedLineOptionIndex + 1);
                        }),
                        r._UZ(6, "svg-icon", 45),
                        r.ALo(7, "translate"),
                        r.qZA(),
                        r.qZA(),
                        r.TgZ(8, "div", 47),
                        r.TgZ(9, "div", 48),
                        r._uU(10),
                        r.ALo(11, "translate"),
                        r.ALo(12, "translate"),
                        r.qZA(),
                        r.YNc(13, De, 1, 2, "span", 49),
                        r.qZA(),
                        r.qZA();
                }
                if (2 & e) {
                    const e = r.oxw(2);
                    r.xp6(2),
                        r.ekj("disabled", e.state.line.selectedLineOptionIndex < 1),
                        r.xp6(1),
                        r.s9C("titleText", r.lcZ(4, 9, "action_previous")),
                        r.xp6(2),
                        r.ekj("disabled", e.state.line.selectedLineOptionIndex === e.state.line.selectedLineOptions.length - 1),
                        r.xp6(1),
                        r.s9C("titleText", r.lcZ(7, 11, "action_next")),
                        r.xp6(4),
                        r.AsE(" ", r.lcZ(11, 13, "ls_option"), " - ", r.xi3(12, 15, "many_stops", e.getTranslateParams(null == e.state.line.displayedLine ? null : e.state.line.displayedLine.stops.length)), " "),
                        r.xp6(3),
                        r.Q6J("ngForOf", e.state.line.selectedLineOptions);
                }
            }
            function Ee(e, i) {
                if (1 & e) {
                    const e = r.EpF();
                    r.TgZ(0, "div", 5),
                        r.YNc(1, Ze, 2, 1, "div", 6),
                        r.TgZ(2, "div", 7),
                        r.TgZ(3, "div", 8),
                        r.TgZ(4, "mv-back-button", 9),
                        r.NdJ("backClick", function () {
                            return r.CHM(e), r.oxw().onBack();
                        }),
                        r.qZA(),
                        r.TgZ(5, "div", 10),
                        r._UZ(6, "span", 11),
                        r.ALo(7, "safeHtml"),
                        r.ALo(8, "async"),
                        r.TgZ(9, "div", 12),
                        r.YNc(10, _e, 2, 1, "div", 13),
                        r.YNc(11, Te, 2, 1, "div", 14),
                        r.qZA(),
                        r.YNc(12, Ie, 1, 1, "mv-share", 15),
                        r.qZA(),
                        r.qZA(),
                        r.YNc(13, ze, 2, 1, "div", 16),
                        r.qZA(),
                        r.TgZ(14, "div", 17),
                        r.TgZ(15, "div", 18),
                        r.YNc(16, qe, 4, 1, "div", 19),
                        r.YNc(17, Me, 9, 8, "div", 20),
                        r.qZA(),
                        r.YNc(18, Je, 14, 18, "div", 21),
                        r.qZA(),
                        r.qZA();
                }
                if (2 & e) {
                    const e = r.oxw();
                    r.xp6(1),
                        r.Q6J("ngIf", e.futureMode),
                        r.xp6(1),
                        r.ekj("long-line-name", e.isLongName),
                        r.xp6(4),
                        r.Q6J("innerHTML", r.lcZ(7, 11, r.lcZ(8, 13, e.state.line.lineGroup.imageHtml)), r.oJD),
                        r.xp6(4),
                        r.Q6J("ngIf", e.title),
                        r.xp6(1),
                        r.Q6J("ngIf", e.subTitle),
                        r.xp6(1),
                        r.Q6J("ngIf", !e.shouldHideSharing),
                        r.xp6(1),
                        r.Q6J("ngIf", e.state.line.lineAlert),
                        r.xp6(3),
                        r.Q6J("ngIf", e.state.line.selectedLine),
                        r.xp6(1),
                        r.Q6J("ngIf", e.state.line.lineDirections.length > 1),
                        r.xp6(1),
                        r.Q6J("ngIf", e.state.line.selectedLineOptions.length > 1);
                }
            }
            function Fe(e, i) {
                if ((1 & e && (r.TgZ(0, "div", 59), r.TgZ(1, "span", 60), r._uU(2), r.ALo(3, "translate"), r.qZA(), r.TgZ(4, "span", 61), r._uU(5), r.qZA(), r.qZA()), 2 & e)) {
                    const e = r.oxw(),
                        i = e.$implicit,
                        t = e.index,
                        n = r.oxw(2);
                    r.xp6(2), r.hij("", r.lcZ(3, 2, "tripplan_itinerary_schedule_full_header"), ": "), r.xp6(3), r.Oqu(n.lineRealTimeService.getNextArrivals(i, t));
                }
            }
            function Qe(e, i) {
                if (1 & e) {
                    const e = r.EpF();
                    r.TgZ(0, "a", 62),
                        r.NdJ("click", function () {
                            r.CHM(e);
                            const i = r.oxw(),
                                t = i.$implicit,
                                n = i.index;
                            return r.oxw(2).openStopSchedule(t, n);
                        })("keydown.enter", function () {
                            r.CHM(e);
                            const i = r.oxw(),
                                t = i.$implicit,
                                n = i.index;
                            return r.oxw(2).openStopSchedule(t, n);
                        }),
                        r._uU(1),
                        r.ALo(2, "translate"),
                        r.qZA();
                }
                2 & e && (r.xp6(1), r.hij(" ", r.lcZ(2, 1, "view_full_schedule"), " "));
            }
            function Ue(e, i) {
                1 & e && (r.TgZ(0, "div", 67), r._uU(1), r.ALo(2, "translate"), r.qZA()), 2 & e && (r.xp6(1), r.hij(" ", r.lcZ(2, 1, "tripplan_itinerary_schedule_header"), " "));
            }
            function Re(e, i) {
                if ((1 & e && (r.TgZ(0, "span"), r._uU(1), r.qZA()), 2 & e)) {
                    const e = r.oxw(2),
                        i = e.$implicit,
                        t = e.index,
                        n = r.oxw(2);
                    r.xp6(1), r.hij(" ", n.lineRealTimeService.getStopArrival(i, 0, t), " ");
                }
            }
            function Ge(e, i) {
                if ((1 & e && (r.TgZ(0, "span", 68), r._UZ(1, "span", 69), r._uU(2), r.qZA()), 2 & e)) {
                    const e = r.oxw(4);
                    r.xp6(2), r.hij(" ", e.realTime, " ");
                }
            }
            function Be(e, i) {
                if ((1 & e && (r.TgZ(0, "div", 63), r.YNc(1, Ue, 3, 3, "div", 64), r.TgZ(2, "div", 65), r.YNc(3, Re, 2, 1, "span", 2), r.YNc(4, Ge, 3, 1, "span", 66), r.qZA(), r.qZA()), 2 & e)) {
                    const e = r.oxw(),
                        i = e.$implicit,
                        t = e.index,
                        n = r.oxw(2);
                    r.xp6(1), r.Q6J("ngIf", n.state.metro.currentConditions.minimalData), r.xp6(2), r.Q6J("ngIf", n.lineRealTimeService.hasStopArrivals(i, 0, t) && !n.realTime), r.xp6(1), r.Q6J("ngIf", n.realTime);
                }
            }
            function He(e, i) {
                if (1 & e) {
                    const e = r.EpF();
                    r.TgZ(0, "div", 54),
                        r.NdJ("click", function () {
                            const i = r.CHM(e).index;
                            return r.oxw(2).onStopClick(i);
                        })("keydown.enter", function () {
                            const i = r.CHM(e).index;
                            return r.oxw(2).onStopClick(i);
                        }),
                        r.TgZ(1, "div"),
                        r.TgZ(2, "div", 55),
                        r._uU(3),
                        r.qZA(),
                        r.YNc(4, Fe, 6, 4, "div", 56),
                        r.YNc(5, Qe, 3, 3, "a", 57),
                        r.qZA(),
                        r.YNc(6, Be, 5, 3, "div", 58),
                        r.qZA();
                }
                if (2 & e) {
                    const e = i.$implicit,
                        t = i.index,
                        n = r.oxw(2);
                    r.ekj("selected", n.isSelectedStop(e.id, t)),
                        r.Q6J("id", n.getStopElementId(t)),
                        r.xp6(3),
                        r.hij(" ", e.name, " "),
                        r.xp6(1),
                        r.Q6J("ngIf", n.state.metro.currentConditions.minimalData && n.lineRealTimeService.hasStopArrivals(e, 1, t)),
                        r.xp6(1),
                        r.Q6J("ngIf", !n.state.metro.currentConditions.minimalData),
                        r.xp6(1),
                        r.Q6J("ngIf", n.isSelectedStop(e.id, t));
                }
            }
            function $e(e, i) {
                if ((1 & e && (r.TgZ(0, "div", 51), r._UZ(1, "mv-updates-message", 52), r.YNc(2, He, 7, 7, "div", 53), r.qZA()), 2 & e)) {
                    const e = r.oxw();
                    r.uIk("aria-activedescendant", e.ariaSelectedStop), r.xp6(1), r.Q6J("message", e.message), r.xp6(1), r.Q6J("ngForOf", e.state.line.displayedLine.stops);
                }
            }
            function Pe(e, i) {
                if (1 & e) {
                    const e = r.EpF();
                    r.ynx(0),
                        r.TgZ(1, "div", 7),
                        r.TgZ(2, "mv-back-button", 9),
                        r.NdJ("backClick", function () {
                            return r.CHM(e), r.oxw().onBack();
                        }),
                        r.qZA(),
                        r.qZA(),
                        r.TgZ(3, "div", 70),
                        r._UZ(4, "svg-icon", 71),
                        r.ALo(5, "translate"),
                        r.TgZ(6, "div", 72),
                        r._uU(7),
                        r.ALo(8, "translate"),
                        r.qZA(),
                        r.qZA(),
                        r.BQk();
                }
                2 & e && (r.xp6(4), r.s9C("titleText", r.lcZ(5, 2, "NoTripPlanFoundTitle")), r.xp6(3), r.Oqu(r.lcZ(8, 4, "line_no_results")));
            }
            function Ve(e, i) {
                if ((1 & e && (r.TgZ(0, "option", 36), r._uU(1), r.qZA()), 2 & e)) {
                    const e = i.$implicit;
                    r.Q6J("ngValue", e), r.xp6(1), r.hij(" ", e.text, " ");
                }
            }
            function je(e, i) {
                if (1 & e) {
                    const e = r.EpF();
                    r.TgZ(0, "div", 73),
                        r.TgZ(1, "div", 74),
                        r._uU(2),
                        r.ALo(3, "translate"),
                        r.qZA(),
                        r.TgZ(4, "div", 75),
                        r.TgZ(5, "div", 76),
                        r.TgZ(6, "select", 34),
                        r.NdJ("ngModelChange", function (i) {
                            return r.CHM(e), r.oxw().onDayChange(i);
                        }),
                        r.YNc(7, Ve, 2, 2, "option", 35),
                        r.qZA(),
                        r.TgZ(8, "span", 32),
                        r._uU(9),
                        r.ALo(10, "translate"),
                        r.qZA(),
                        r.qZA(),
                        r.qZA(),
                        r.qZA();
                }
                if (2 & e) {
                    const e = r.oxw();
                    r.xp6(2),
                        r.hij(" ", r.lcZ(3, 4, "line_detail_empty_options_selected_time"), " "),
                        r.xp6(4),
                        r.Q6J("ngModel", e.selectedDay),
                        r.xp6(1),
                        r.Q6J("ngForOf", e.lineService.dayOptions),
                        r.xp6(2),
                        r.Oqu(r.lcZ(10, 6, "line_change_time"));
                }
            }
            function Ke(e, i) {
                if ((1 & e && r._UZ(0, "mv-qr-code-banner", 77), 2 & e)) {
                    const e = r.oxw();
                    r.Q6J("qrCodeParams", e.qrParams);
                }
            }
            const Xe = (0, se.hu)("LineViewComponent");
            let We = (() => {
                class e {
                    constructor(e, i, t, n, a, o, s, l, r, c, p, d, m, h, v, u, g) {
                        (this.routingService = e),
                            (this.lineService = i),
                            (this.lineRealTimeService = t),
                            (this.canonicalService = n),
                            (this.store = a),
                            (this.lineActions = o),
                            (this.analyticsService = s),
                            (this.universal = l),
                            (this.a11y = r),
                            (this.lineTemplateService = c),
                            (this.translate = p),
                            (this.storeHelper = d),
                            (this.permissionService = m),
                            (this.elementRef = h),
                            (this.document = v),
                            (this.splashDisplayService = u),
                            (this.platformService = g),
                            (this.qrParams = { campaign: re.oS.Lines_QRcode, appArea: re.Kq.QR, deepLinkSchemaType: ce.nu.Lines, promoKey: "web_scan_qr", displayDirection: "top" }),
                            (this.message = { backgroundColor: "#e6f1fd", text: "web_stations_choose_station_message" }),
                            (this.completedInitialFocus = !1);
                    }
                    get state() {
                        return this.store.getState();
                    }
                    get futureMode() {
                        return this.state.line.selectedDayOffset != (0, oe.i7)();
                    }
                    get realTime() {
                        return this.lineRealTimeService.realTimeResult || "";
                    }
                    get shouldShowNoLine() {
                        return this.state.global.appIsReady && !this.state.global.isLoading && !this.state.line.lineDirections.length;
                    }
                    get shouldShowEmptyState() {
                        return !this.shouldShowNoLine && this.state.global.appIsReady && !this.state.line.selectedLineOptions.length;
                    }
                    get isShowQRBanner() {
                        return this.platformService.isDesktop && !this.state.global.isLoading && !this.shouldShowEmptyState;
                    }
                    get shouldHideSharing() {
                        var e;
                        return null === (e = this.state.customer.currentCustomer) || void 0 === e ? void 0 : e.designConfiguration.hideSharing;
                    }
                    get selectedLine() {
                        return this.state.line.selectedLine;
                    }
                    ngOnInit() {
                        if ((this.lineService.populateDayOptions(), this.universal.isBrowser && this.document.querySelector(".app-container").scrollIntoView(), !this.initTitles())) {
                            const e = this.storeHelper.subscribe("line.selectedLine", (i) => {
                                i && this.initTitles() && e();
                            });
                        }
                    }
                    get isSelectClosestStationSupported() {
                        var e, i, t;
                        return null === (t = null === (i = null === (e = this.state.global) || void 0 === e ? void 0 : e.featureFlags) || void 0 === i ? void 0 : i.lineViewExpandClosestStation) || void 0 === t ? void 0 : t.isActive;
                    }
                    ngAfterViewInit() {
                        var e;
                        if (this.universal.isBrowser)
                            if (null === (e = this.state.line.displayedLine) || void 0 === e ? void 0 : e.stops)
                                setTimeout(() => {
                                    this.selectClosestStation();
                                });
                            else {
                                const e = this.storeHelper.subscribe("line.displayedLine", (i) => {
                                    (null == i ? void 0 : i.stops) &&
                                        (e(),
                                        setTimeout(() => {
                                            this.selectClosestStation();
                                        }));
                                });
                            }
                    }
                    ngAfterViewChecked() {
                        var e;
                        !this.completedInitialFocus && this.backButton && this.a11y.byEnter && (null === (e = this.backButton.nativeElement) || void 0 === e || e.focus(), (this.completedInitialFocus = !0));
                    }
                    initTitles() {
                        var e, i, t;
                        const n = null === (t = null === (i = null === (e = this.state.line) || void 0 === e ? void 0 : e.selectedLine) || void 0 === i ? void 0 : i.presentationLine) || void 0 === t ? void 0 : t[m.vU.LineDetail];
                        return !!n && ((this.title = n.title), (this.subTitle = n.subTitle), (this.isLongName = n.title.length > 8 && this.isMobile), !0);
                    }
                    get isMobile() {
                        return this.platformService.isMobile;
                    }
                    get isDesktop() {
                        return this.platformService.isDesktop;
                    }
                    getStationFromUrl() {
                        let e = -1;
                        const i = this.routingService.getStateFromUrl();
                        return i.stopId && (e = "number" != typeof i.stopIndex || Number.isNaN(i.stopIndex) ? this.state.line.displayedLine.stops.findIndex((e) => e.id === i.stopId) : i.stopIndex), e;
                    }
                    closestStationIndex() {
                        var e;
                        return (0, o.mG)(this, void 0, void 0, function* () {
                            let i,
                                t = this.getStationFromUrl();
                            if (-1 !== t || ((t = 0), !this.isSelectClosestStationSupported || !(yield this.permissionService.requestLocation({ subtitle: "permissions_location_station_message" })))) return t;
                            try {
                                i = null === (e = yield this.permissionService.getLocation({ timeout: 5e3, maximumAge: 36e5 })) || void 0 === e ? void 0 : e.coords;
                            } catch (a) {
                                Xe.error("selectClosestStation fail", a);
                            }
                            if (!i) return t;
                            const n = { stopIndex: -1, distance: Number.MAX_SAFE_INTEGER };
                            return (
                                this.state.line.displayedLine.stops
                                    .filter((e) => e.location)
                                    .forEach((e, t) => {
                                        const a = V._.fromMvLatLon(e.location),
                                            o = (0, j.YQ)(i.latitude, i.longitude, a.lat, a.lng, "K");
                                        o < n.distance && ((n.distance = o), (n.stopIndex = t));
                                    }),
                                n.distance <= 5 && (t = n.stopIndex),
                                t
                            );
                        });
                    }
                    selectClosestStation() {
                        var e;
                        return (0, o.mG)(this, void 0, void 0, function* () {
                            const i = yield this.closestStationIndex();
                            this.onStopClick(i);
                            const t = this.getStopElementId(i),
                                n = (null === (e = this.document.getElementById(t)) || void 0 === e ? void 0 : e.offsetTop) - this.elementRef.nativeElement.offsetTop;
                            this.splashDisplayService.removeListenerOfScrollToTop(), this.document.body.parentElement.scrollTo({ behavior: "smooth", top: n, left: 0 });
                        });
                    }
                    onBack() {
                        this.routingService.redirectTo(this.canonicalService.buildStatefulPath([":tab", ":locale"]));
                    }
                    onLineChange(e) {
                        this.analyticsService.trackLinesAction("line changed", e.lineTitle), this.store.dispatch(this.lineActions.selectLine(e)), this.initTitles(), this.selectClosestStation();
                    }
                    onLineOptionChange(e) {
                        e >= 0 && e < this.state.line.selectedLineOptions.length && this.analyticsService.trackLinesAction("line option change", `Line option - ${this.selectedLine.lineOptions[e].stops.length} stops`.toString()),
                            this.store.dispatch(this.lineActions.selectLineOption(e));
                    }
                    onAlertClick() {
                        const e = this.state.line.lineAlert;
                        this.routingService.redirectTo(this.canonicalService.buildStatefulPath([], P.zA.ALERTS_SINGLE_VIEW), { etype: e.entityIdentidier.entityType, eid: e.entityIdentidier.id });
                    }
                    onStopClick(e) {
                        const i = this.state.line.displayedLine.stops[e];
                        if (this.state.line.selectedStopId !== i.id || this.state.line.selectedStopIndex !== e) {
                            if (!this.futureMode) {
                                const e = this.state.line.selectedSubgroup ? this.state.line.selectedSubgroup.lines.map((e) => e.lineId) : [this.selectedLine.lineId];
                                this.lineRealTimeService.runRealTime(i.id, e);
                            }
                            this.store.dispatch(this.lineActions.selectStop(i.id, e)), this.analyticsService.trackLinesAction("line stop selected", { id: i.id, name: i.name });
                        }
                    }
                    openStopSchedule(e, i) {
                        Xe.log("openStopSchedule", { stop: e, stops: this.state.line.displayedLine.stops, lines: this.state.line.selectedSubgroup ? this.state.line.selectedSubgroup.lines : [this.selectedLine] }),
                            this.analyticsService.trackLinesAction("view stop schedule", { id: e.id, name: e.name }),
                            this.routingService.updateUrlParams({ sid: e.id, sidx: i });
                    }
                    onDayChange(e) {
                        this.analyticsService.trackLinesAction("line day change", { day: e.text }),
                            this.store.dispatch(this.lineActions.loadLineGroup(this.state.line.lineGroup.lineGroupId, this.selectedLine.lineId, (0, oe.i7)() + Number(e.value)));
                    }
                    getLineTitle(e) {
                        let i = "";
                        if (!e) return i;
                        const { origin: t, destination: n, type: a, title: o, presentationLine: s } = e;
                        if (((i = a === ae.SP.SUBGROUP ? o : t && n ? `${t} ${this.lineTemplateService.getArrowDelimiterToken()} ${n}` : t || n), !i)) {
                            const e = null == s ? void 0 : s[m.vU.RideMode];
                            i = o || (null == e ? void 0 : e.title) || (null == e ? void 0 : e.subTitle) || "";
                        }
                        return i;
                    }
                    getTranslateParams(...e) {
                        return { param1: e[0] };
                    }
                    getStopElementId(e) {
                        var i;
                        return `stop-${null === (i = this.state.line.displayedLine.stops[e]) || void 0 === i ? void 0 : i.id}-${e}`;
                    }
                    get ariaSelectedStop() {
                        return this.state.line.selectedStopId ? this.getStopElementId(this.state.line.selectedStopIndex) : null;
                    }
                    isSelectedStop(e, i) {
                        return this.state.line.selectedStopId === e && this.state.line.selectedStopIndex === i;
                    }
                    ngOnDestroy() {
                        this.lineRealTimeService.terminateRealTime();
                    }
                }
                return (
                    (e.ɵfac = function (i) {
                        return new (i || e)(
                            r.Y36(p.Z),
                            r.Y36(pe.Z),
                            r.Y36(be),
                            r.Y36(f.z),
                            r.Y36(d.d),
                            r.Y36(c.J),
                            r.Y36(h.y),
                            r.Y36(I.p),
                            r.Y36(xe.F),
                            r.Y36(ye.$),
                            r.Y36(k.sK),
                            r.Y36(X.N),
                            r.Y36(we.$),
                            r.Y36(r.SBq),
                            r.Y36(n.K0),
                            r.Y36(v.Y),
                            r.Y36(g.mi)
                        );
                    }),
                    (e.ɵcmp = r.Xpm({
                        type: e,
                        selectors: [["mv-line-view"]],
                        viewQuery: function (e, i) {
                            if ((1 & e && (r.Gf(Ae, 5), r.Gf(le.p6, 5)), 2 & e)) {
                                let e;
                                r.iGM((e = r.CRH())) && (i.backButton = e.first), r.iGM((e = r.CRH())) && (i.trigger = e.first);
                            }
                        },
                        decls: 5,
                        vars: 5,
                        consts: [
                            ["class", "lines-header-container", 4, "ngIf"],
                            ["class", "stops-list", "role", "list", 4, "ngIf"],
                            [4, "ngIf"],
                            ["class", "empty-results", 4, "ngIf"],
                            [3, "qrCodeParams", 4, "ngIf"],
                            [1, "lines-header-container"],
                            ["class", "date-header", 4, "ngIf"],
                            [1, "line-group-header"],
                            [1, "line-group-header-inner"],
                            [1, "black-fill", 3, "backClick"],
                            [1, "line-info-wrapper"],
                            [1, "line-image", 3, "innerHTML"],
                            [1, "line-names"],
                            ["class", "line-title", "role", "heading", "aria-level", "1", 4, "ngIf"],
                            ["class", "line-subtitle", "role", "heading", "aria-level", "2", 4, "ngIf"],
                            [3, "showCaption", 4, "ngIf"],
                            ["tabindex", "0", "class", "alert", 3, "click", "keydown.enter", 4, "ngIf"],
                            [1, "line-container"],
                            [1, "line-header"],
                            ["class", "line-name", "aria-hidden", "false", "style", "", 4, "ngIf"],
                            ["class", "dropdown-menu", 4, "ngIf"],
                            ["class", "options-nav", 4, "ngIf"],
                            [1, "date-header"],
                            ["role", "heading", "aria-level", "1", 1, "line-title"],
                            ["role", "heading", "aria-level", "2", 1, "line-subtitle"],
                            [3, "showCaption"],
                            ["tabindex", "0", 1, "alert", 3, "click", "keydown.enter"],
                            ["aria-hidden", "false", 1, "line-name"],
                            ["id", "line-name", "role", "heading", "aria-level", "2"],
                            [1, "dropdown-menu"],
                            [4, "ngIf", "ngIfElse"],
                            ["desktopLineDirectionsMenu", ""],
                            [1, "menu-label"],
                            ["src", "images/icons/expand_white.svg", "mvAccessibleSVG", "", 3, "titleText"],
                            [1, "lines-dropdown", 3, "ngModel", "ngModelChange"],
                            [3, "ngValue", 4, "ngFor", "ngForOf"],
                            [3, "ngValue"],
                            [1, "lines-dropdown", 3, "matMenuTriggerFor"],
                            ["tabindex", "0"],
                            ["optionsMenu", "matMenu"],
                            ["mat-menu-item", "", 3, "click", 4, "ngFor", "ngForOf"],
                            ["mat-menu-item", "", 3, "click"],
                            [1, "options-nav"],
                            [1, "step-nav-nextprev-container"],
                            [1, "step-nav-prev", 3, "click"],
                            ["src", "images/icons/tab-arrow.svg", "mvAccessibleSVG", "", 3, "titleText"],
                            [1, "step-nav-next", 3, "click"],
                            [1, "options"],
                            [1, "line-option-title"],
                            ["class", "option", 3, "selected", "click", 4, "ngFor", "ngForOf"],
                            [1, "option", 3, "click"],
                            ["role", "list", 1, "stops-list"],
                            [3, "message"],
                            ["class", "stop-item", "role", "listitem", "tabindex", "0", 3, "selected", "id", "click", "keydown.enter", 4, "ngFor", "ngForOf"],
                            ["role", "listitem", "tabindex", "0", 1, "stop-item", 3, "id", "click", "keydown.enter"],
                            [1, "title"],
                            ["class", "additional-times", 4, "ngIf"],
                            ["tabindex", "0", 3, "click", "keydown.enter", 4, "ngIf"],
                            ["class", "arrivals", 4, "ngIf"],
                            [1, "additional-times"],
                            [1, "label"],
                            [1, "times"],
                            ["tabindex", "0", 3, "click", "keydown.enter"],
                            [1, "arrivals"],
                            ["class", "arrival-description", 4, "ngIf"],
                            [1, "current"],
                            ["class", "realtime", 4, "ngIf"],
                            [1, "arrival-description"],
                            [1, "realtime"],
                            [1, "realtime-icon"],
                            ["role", "status", 1, "empty-results"],
                            ["src", "images/error-states/img_empty_state_omni.svg", "mvAccessibleSVG", "", 1, "icon", 3, "titleText"],
                            [1, "message"],
                            [1, "empty-results"],
                            ["role", "status", 1, "message"],
                            [1, "change-time"],
                            [1, "dropdown-menu", "time-options"],
                            [3, "qrCodeParams"],
                        ],
                        template: function (e, i) {
                            1 & e && (r.YNc(0, Ee, 19, 15, "div", 0), r.YNc(1, $e, 3, 3, "div", 1), r.YNc(2, Pe, 9, 6, "ng-container", 2), r.YNc(3, je, 11, 8, "div", 3), r.YNc(4, Ke, 1, 1, "mv-qr-code-banner", 4)),
                                2 & e &&
                                    (r.Q6J("ngIf", !i.state.global.isLoading && i.state.line.selectedLine),
                                    r.xp6(1),
                                    r.Q6J("ngIf", null == i.state.line.displayedLine ? null : i.state.line.displayedLine.stops),
                                    r.xp6(1),
                                    r.Q6J("ngIf", i.shouldShowNoLine),
                                    r.xp6(1),
                                    r.Q6J("ngIf", i.shouldShowEmptyState),
                                    r.xp6(1),
                                    r.Q6J("ngIf", i.isShowQRBanner));
                        },
                        directives: [n.O5, w.W, ke.N, b.bk, x.m, y.EJ, y.JJ, y.On, n.sg, y.YN, y.Kr, le.p6, le.VK, le.OP, Se.Q, Le.Y],
                        pipes: [z.z, n.Ov, k.X$],
                        styles: [
                            '@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-line-view{display:flex;flex-direction:column;background:#FFFFFF;height:100%;-webkit-overflow-scrolling:touch}mv-line-view .spinner{margin-top:50px;text-align:center}mv-line-view .dropdown-menu{position:relative;display:inline-block}mv-line-view .dropdown-menu .lines-dropdown{position:absolute;opacity:0;top:0;width:100%;height:100%;z-index:9;padding:4px 0}html[dir=ltr] mv-line-view .dropdown-menu .lines-dropdown{left:0}html[dir=rtl] mv-line-view .dropdown-menu .lines-dropdown{right:0}mv-line-view .dropdown-menu .lines-dropdown:focus+span{outline:auto}mv-line-view .lines-header-container{width:100%;background-color:#fff;z-index:3}html body.mobile mv-line-view .lines-header-container{top:4.7058823529rem}html.privacy-notice body.mobile mv-line-view .lines-header-container{top:calc(4.7058823529rem + 2.9411764706rem)}@media only screen and (max-width: 500px){html.privacy-notice body.mobile mv-line-view .lines-header-container{top:calc(4.7058823529rem + 4.7058823529rem)}}html body[data-top-banner=true].mobile:not([class*=c_]) mv-line-view .lines-header-container,body[data-top-banner=true].mobile[class*=c_4908] mv-line-view .lines-header-container,body[data-top-banner=true].mobile[class*=c_4480] mv-line-view .lines-header-container{top:calc(4.7058823529rem + 60px)}html.privacy-notice body.mobile[data-top-banner=true]:not([class*=c_]) mv-line-view .lines-header-container,html.privacy-notice body[data-top-banner=true].mobile[class*=c_4908] mv-line-view .lines-header-container,html.privacy-notice body[data-top-banner=true].mobile[class*=c_4480] mv-line-view .lines-header-container{top:calc(4.7058823529rem + 60px + 2.9411764706rem)}@media only screen and (max-width: 500px){html.privacy-notice body.mobile[data-top-banner=true]:not([class*=c_]) mv-line-view .lines-header-container,html.privacy-notice body[data-top-banner=true].mobile[class*=c_4908] mv-line-view .lines-header-container,html.privacy-notice body[data-top-banner=true].mobile[class*=c_4480] mv-line-view .lines-header-container{top:calc(4.7058823529rem + 60px + 4.7058823529rem)}}html body.mobile.landscape mv-line-view .lines-header-container{top:2.3529411765rem}html.privacy-notice body.mobile.landscape mv-line-view .lines-header-container{top:calc(2.3529411765rem + 2.9411764706rem)}@media only screen and (max-width: 500px){html.privacy-notice body.mobile.landscape mv-line-view .lines-header-container{top:calc(2.3529411765rem + 4.7058823529rem)}}html body[data-top-banner=true].mobile.landscape:not([class*=c_]) mv-line-view .lines-header-container,body[data-top-banner=true].mobile.landscape[class*=c_4908] mv-line-view .lines-header-container,body[data-top-banner=true].mobile.landscape[class*=c_4480] mv-line-view .lines-header-container{top:calc(2.3529411765rem + 60px)}html.privacy-notice body.mobile.landscape[data-top-banner=true]:not([class*=c_]) mv-line-view .lines-header-container,html.privacy-notice body[data-top-banner=true].mobile.landscape[class*=c_4908] mv-line-view .lines-header-container,html.privacy-notice body[data-top-banner=true].mobile.landscape[class*=c_4480] mv-line-view .lines-header-container{top:calc(2.3529411765rem + 60px + 2.9411764706rem)}@media only screen and (max-width: 500px){html.privacy-notice body.mobile.landscape[data-top-banner=true]:not([class*=c_]) mv-line-view .lines-header-container,html.privacy-notice body[data-top-banner=true].mobile.landscape[class*=c_4908] mv-line-view .lines-header-container,html.privacy-notice body[data-top-banner=true].mobile.landscape[class*=c_4480] mv-line-view .lines-header-container{top:calc(2.3529411765rem + 60px + 4.7058823529rem)}}body.mobile mv-line-view .lines-header-container{position:fixed}mv-line-view .date-header{background-color:#ecf0f1;box-sizing:border-box;display:block;line-height:1;overflow:hidden;padding:7px 20px 5px;text-overflow:ellipsis;font-size:.9411764706rem;color:#292a30;white-space:nowrap;width:100%}mv-line-view .line-group-header{display:flex;padding:13px 20px;position:relative;font-size:.8235294118rem;min-height:27px;width:100%;box-sizing:border-box}html[dir=ltr] mv-line-view .line-group-header{padding-left:40px}html[dir=rtl] mv-line-view .line-group-header{padding-right:40px}@media screen and (min-width: 500px){body.mobile.landscape mv-line-view .line-group-header{padding:11px 20px 10px;min-height:20px}}body.mobile mv-line-view .line-group-header .line-group-header-inner{flex-grow:1;align-self:center}mv-line-view .line-group-header .line-info-wrapper{display:flex;align-items:center;flex-grow:1}mv-line-view .line-group-header .line-info-wrapper div:only-child{font-size:.9411764706rem}mv-line-view .line-group-header .line-info-wrapper mv-share{display:none}mv-line-view .line-group-header .line-image{display:table-cell;vertical-align:top}html[dir=ltr] mv-line-view .line-group-header .line-image{padding-right:10px}html[dir=rtl] mv-line-view .line-group-header .line-image{padding-left:10px}mv-line-view .line-group-header .line-image svg-icon{margin:0}mv-line-view .line-group-header .line-names{flex-grow:1}mv-line-view .line-group-header .line-title{font-size:.9411764706rem}@media screen and (min-width: 500px){body.mobile.landscape mv-line-view .line-group-header .line-title{padding-top:0}}mv-line-view .line-group-header .line-subtitle{font-size:.8235294118rem}mv-line-view .line-group-header.long-line-name .alert{content:url(/images/icons/alert-circle-orange.svg);background:none;width:18px;border-radius:0}html[dir=ltr] mv-line-view .line-group-header.long-line-name .alert{padding-left:14px}html[dir=rtl] mv-line-view .line-group-header.long-line-name .alert{padding-right:14px}html[dir=ltr] mv-line-view .line-group-header.long-line-name .alert{padding-right:0}html[dir=rtl] mv-line-view .line-group-header.long-line-name .alert{padding-left:0}mv-line-view .line-group-header.long-line-name .alert:hover{background:none}mv-line-view .line-group-header .alert{font-size:.8235294118rem;color:#292a30;background:#c6522c;min-height:14px;width:-webkit-min-content;width:-moz-min-content;width:min-content;border-radius:20px;color:#fff;cursor:pointer;display:inline-block;margin:5px 0;outline-color:#302e2e;padding:6px 8px;position:relative;vertical-align:middle;transition:all,.3s;line-height:1}html[dir=ltr] mv-line-view .line-group-header .alert{padding-right:18px}html[dir=rtl] mv-line-view .line-group-header .alert{padding-left:18px}html[dir=ltr] mv-line-view .line-group-header .alert{padding-left:24px}html[dir=rtl] mv-line-view .line-group-header .alert{padding-right:24px}html[dir=ltr] mv-line-view .line-group-header .alert{margin-left:5px}html[dir=rtl] mv-line-view .line-group-header .alert{margin-right:5px}@media screen and (min-width: 500px){body.mobile.landscape mv-line-view .line-group-header .alert{position:absolute;top:0}html[dir=ltr] body.mobile.landscape mv-line-view .line-group-header .alert{right:60px}html[dir=rtl] body.mobile.landscape mv-line-view .line-group-header .alert{left:60px}}mv-line-view .line-group-header .alert:before{background:url(/images/icons/alert-circle.svg) no-repeat;background-size:contain;content:"";display:inline-block;height:12px;position:absolute;top:50%;vertical-align:middle;width:12px;transform:translateY(-50%)}html[dir=ltr] mv-line-view .line-group-header .alert:before{left:8px}html[dir=rtl] mv-line-view .line-group-header .alert:before{right:8px}html[dir=ltr] mv-line-view .line-group-header .alert:before{margin-right:6px}html[dir=rtl] mv-line-view .line-group-header .alert:before{margin-left:6px}html[dir=ltr] mv-line-view .line-group-header .alert:before{left:7px}html[dir=rtl] mv-line-view .line-group-header .alert:before{right:7px}mv-line-view .line-group-header .alert:after{background:url(/images/icons/alert-arrow.svg) no-repeat;background-size:contain;content:"";display:inline-block;height:9px;position:absolute;top:50%;vertical-align:middle;width:5px;transform:translateY(-50%)}html[dir=ltr] mv-line-view .line-group-header .alert:after{right:8px}html[dir=rtl] mv-line-view .line-group-header .alert:after{left:8px}html[dir=rtl] mv-line-view .line-group-header .alert:after{transform:scaleX(-1);top:10px}mv-line-view .line-group-header .alert:hover{background:#d35f39}mv-line-view .line-group-header .alert:focus{outline:#302E2E auto 1px}body.mobile mv-line-view mv-back-button{display:none}@media screen and (min-width: 500px){body.mobile.landscape mv-line-view mv-back-button{display:block}}mv-line-view .line-container .line-header{background:#292A30;padding:20px;position:relative}@media screen and (min-width: 500px){body.mobile.landscape mv-line-view .line-container .line-header{padding:10px 20px;display:flex;justify-content:space-between}}mv-line-view .line-container .line-header .line-name{color:#fff;line-height:1}mv-line-view .line-container .line-header .line-name span{display:block;font-size:.9411764706rem;width:100%}mv-line-view .line-container .line-header .lines{font-size:.7058823529rem;margin:0;padding:0}mv-line-view .line-container .line-header .lines a{display:inline-block;color:#0895e4;padding-top:4px;text-decoration:none;transition:all .3s}mv-line-view .line-container .line-header .lines a:hover{color:#28adf7}mv-line-view .line-container .line-header .lines a:hover .cls-1{fill:#28adf7}mv-line-view .line-container .line-header .lines a svg-icon{height:10px;width:10px}html[dir=ltr] mv-line-view .line-container .line-header .lines a svg-icon{margin-left:2px}html[dir=rtl] mv-line-view .line-container .line-header .lines a svg-icon{margin-right:2px}mv-line-view .line-container .line-header .lines a svg-icon .cls-1{fill:#0895e4;transition:all .3s}mv-line-view .line-container .line-header .dropdown-menu .menu-label{color:#0a93ff;font-size:.7058823529rem}mv-line-view .line-container .line-header .dropdown-menu svg-icon{width:10px;height:10px}html[dir=ltr] mv-line-view .line-container .line-header .dropdown-menu svg-icon{margin-left:2px}html[dir=rtl] mv-line-view .line-container .line-header .dropdown-menu svg-icon{margin-right:2px}mv-line-view .line-container .line-header .dropdown-menu svg-icon svg .cls-1{fill:#0895e4}mv-line-view .options-nav{border-bottom:solid 1px #BDC3C7;padding:5px 0 0;position:relative;text-align:center}mv-line-view .options-nav a.disabled{opacity:.5}mv-line-view .options-nav .step-nav-nextprev-container svg-icon svg{fill:#0000008a}mv-line-view .options-nav .step-nav-prev{opacity:1;position:absolute;transform:translateY(-50%);top:50%;z-index:1;transition:all .3s}html[dir=ltr] mv-line-view .options-nav .step-nav-prev{left:13px}html[dir=rtl] mv-line-view .options-nav .step-nav-prev{right:13px}html[dir=rtl] mv-line-view .options-nav .step-nav-prev svg-icon{transform:scaleX(-1)}mv-line-view .options-nav .step-nav-next{opacity:1;position:absolute;transform:translateY(-50%);top:50%;z-index:1;transition:all .3s}html[dir=ltr] mv-line-view .options-nav .step-nav-next{right:13px}html[dir=rtl] mv-line-view .options-nav .step-nav-next{left:13px}mv-line-view .options-nav .step-nav-next svg-icon{transform:rotate(180deg)}html[dir=rtl] mv-line-view .options-nav .step-nav-next svg-icon{transform:rotate(0)}mv-line-view .options-nav .options{margin:0 40px;position:relative}mv-line-view .options-nav .options .line-option-title{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%}mv-line-view .options-nav .options .option{background-color:#bdc3c7;border-radius:50%;cursor:pointer;display:inline-block;height:4px;outline:none;padding:0;position:relative;top:-3px;width:4px}html[dir=ltr] mv-line-view .options-nav .options .option{margin-right:5px}html[dir=rtl] mv-line-view .options-nav .options .option{margin-left:5px}html[dir=ltr] mv-line-view .options-nav .options .option:last-of-type{margin-right:0}html[dir=rtl] mv-line-view .options-nav .options .option:last-of-type{margin-left:0}mv-line-view .options-nav .options .option.selected{background-color:#f0500c}mv-line-view .stops-list{flex-grow:1;overflow:hidden}mv-line-view .stops-list mv-updates-message .updates-message-wrapper{margin-bottom:0}.has-back-home mv-line-view .stops-list{padding-bottom:0}mv-line-view .stops-list .stop-item{box-sizing:border-box;cursor:pointer;display:table;height:55px;padding:10px 20px;position:relative;width:100%;background-color:#fff}html[dir=ltr] mv-line-view .stops-list .stop-item{padding-left:52px}html[dir=rtl] mv-line-view .stops-list .stop-item{padding-right:52px}@media screen and (min-width: 500px){body.mobile.landscape mv-line-view .stops-list .stop-item{height:45px}}mv-line-view .stops-list .stop-item:focus{outline:#302E2E auto 1px}mv-line-view .stops-list .stop-item:before{content:"";border-left:solid 3px black;height:100%;position:absolute;top:0}html[dir=ltr] mv-line-view .stops-list .stop-item:before{left:27px}html[dir=rtl] mv-line-view .stops-list .stop-item:before{right:27px}mv-line-view .stops-list .stop-item:after{background-color:#fff;border:solid 4px #292A30;border-radius:50%;content:"";height:5px;position:absolute;top:22px;transition:background-color .3s ease;width:5px}html[dir=ltr] mv-line-view .stops-list .stop-item:after{left:22px}html[dir=rtl] mv-line-view .stops-list .stop-item:after{right:22px}@media screen and (min-width: 500px){body.mobile.landscape mv-line-view .stops-list .stop-item:after{top:17px}}mv-line-view .stops-list .stop-item:first-of-type:before{height:calc(100% - 28px);top:28px}mv-line-view .stops-list .stop-item:last-of-type{margin-bottom:10px}mv-line-view .stops-list .stop-item:last-of-type:before{height:28px}mv-line-view .stops-list .stop-item:hover{background-color:#f5f7f7}mv-line-view .stops-list .stop-item.selected .title{font-weight:bold}mv-line-view .stops-list .stop-item.selected a,mv-line-view .stops-list .stop-item.selected .additional-times{display:inline-block}mv-line-view .stops-list .stop-item.selected a:focus,mv-line-view .stops-list .stop-item.selected .additional-times:focus{outline:#302E2E auto 1px}mv-line-view .stops-list .stop-item.selected:after{background-color:#292a30}mv-line-view .stops-list .stop-item.passed{color:#bdc3c7}mv-line-view .stops-list .stop-item>div{display:table-cell;vertical-align:middle}mv-line-view .stops-list .stop-item .title{font-size:.9411764706rem}mv-line-view .stops-list .stop-item a{color:#0078d6;display:none;font-size:.7058823529rem;text-decoration:underline;transition:all .3s}mv-line-view .stops-list .stop-item a:hover,mv-line-view .stops-list .stop-item a:focus{color:#005ba3}mv-line-view .stops-list .stop-item .arrival-description{font-size:.7058823529rem}mv-line-view .stops-list .stop-item .additional-times{display:none;font-size:.7058823529rem}mv-line-view .stops-list .stop-item .arrivals{display:table-cell;min-width:70px}html[dir=ltr] mv-line-view .stops-list .stop-item .arrivals{text-align:right}html[dir=rtl] mv-line-view .stops-list .stop-item .arrivals{text-align:left}mv-line-view .stops-list .stop-item .arrivals .real-time{color:#038844}mv-line-view .stops-list .stop-item .arrivals .current{font-size:.8235294118rem}mv-line-view .stops-list .stop-item .arrivals .current .realtime{color:#038844}mv-line-view .stops-list .stop-item .arrivals .current .realtime-icon{background:none;border-radius:50%;display:inline-block;height:4px;transform:translateY(-50%);width:4px}html[dir=rtl] mv-line-view .stops-list .stop-item .arrivals .current .realtime-icon{transform:translateY(-50%) scaleX(-1)}mv-line-view .stops-list .stop-item .arrivals .current .realtime-icon:before{border:2px solid transparent;border-left-color:#038844;border-radius:50%;content:"";display:block;height:10px;position:absolute;right:-6px;top:-5px;width:10px;-webkit-animation:fade-in-out 1s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s infinite linear alternate-reverse;animation-fill-mode:both}@media (prefers-reduced-motion: reduce){mv-line-view .stops-list .stop-item .arrivals .current .realtime-icon:before{-webkit-animation:none;animation:none}}mv-line-view .stops-list .stop-item .arrivals .current .realtime-icon:after{border:2px solid transparent;border-left-color:#038844;border-radius:50%;content:"";display:block;height:16px;position:absolute;right:-8px;top:-8px;width:16px;-webkit-animation:fade-in-out 1s .2s infinite linear alternate-reverse;-webkit-animation-fill-mode:both;animation:fade-in-out 1s .2s infinite linear alternate-reverse;animation-fill-mode:both}@media (prefers-reduced-motion: reduce){mv-line-view .stops-list .stop-item .arrivals .current .realtime-icon:after{-webkit-animation:none;animation:none}}mv-line-view .stops-list .stop-item .arrivals .next{color:#bdc3c7;font-size:.7058823529rem}mv-line-view .empty-results{padding:0 20px 20px;text-align:center}mv-line-view .empty-results .message{font-size:.9411764706rem;color:#737578;margin:14px 0;padding:20px}mv-line-view .empty-results .icon{width:32px;height:32px}mv-line-view .empty-results .change-time{display:inline-block}mv-line-view .empty-results .change-time .dropdown-menu{margin-top:30px}mv-line-view .empty-results .change-time .dropdown-menu .dropdown-list{top:-6px}mv-line-view .empty-results .change-time .menu-label{border:solid 1px #0895E4;border-radius:5px;color:#0895e4;padding:5px 10px;text-decoration:none;font-size:.8235294118rem}.app-container.desktop.lines.lines-view mv-header .header{height:3.8235294118rem;min-height:3.8235294118rem}.app-container.desktop.lines.lines-view mv-line-view .stops-list{overflow:scroll}\n',
                        ],
                        encapsulation: 2,
                    })),
                    e
                );
            })();
            var ei = t(33721),
                ii = t(47111),
                ti = t(86607);
            const ni = ["backButton"],
                ai = ["future-arrival"];
            function oi(e, i) {
                1 & e && (r.TgZ(0, "div", 17), r.TgZ(1, "div", 18), r._uU(2), r.ALo(3, "translate"), r.qZA(), r.qZA()), 2 & e && (r.xp6(2), r.Oqu(r.lcZ(3, 1, "line_detail_empty_options_selected_time")));
            }
            function si(e, i) {
                if ((1 & e && (r.TgZ(0, "option", 21), r._uU(1), r.qZA()), 2 & e)) {
                    const e = i.$implicit;
                    r.Q6J("ngValue", e), r.xp6(1), r.hij(" ", e.text, " ");
                }
            }
            function li(e, i) {
                if (1 & e) {
                    const e = r.EpF();
                    r.ynx(0),
                        r.TgZ(1, "select", 19),
                        r.NdJ("ngModelChange", function (i) {
                            return r.CHM(e), r.oxw().onDayChange(i);
                        }),
                        r.YNc(2, si, 2, 2, "option", 20),
                        r.qZA(),
                        r.BQk();
                }
                if (2 & e) {
                    const e = r.oxw();
                    r.xp6(1), r.Q6J("ngModel", e.selectedDay), r.xp6(1), r.Q6J("ngForOf", e.dayOptions);
                }
            }
            function ri(e, i) {
                if (1 & e) {
                    const e = r.EpF();
                    r.TgZ(0, "button", 26),
                        r.NdJ("click", function () {
                            const i = r.CHM(e).$implicit;
                            return r.oxw(2).onDayChange(i);
                        }),
                        r._uU(1),
                        r.qZA();
                }
                if (2 & e) {
                    const e = i.$implicit;
                    r.xp6(1), r.hij(" ", e.text, " ");
                }
            }
            function ci(e, i) {
                if ((1 & e && (r._UZ(0, "button", 22), r.TgZ(1, "mat-menu", 23, 24), r.YNc(3, ri, 2, 1, "button", 25), r.qZA()), 2 & e)) {
                    const e = r.MAs(2),
                        i = r.oxw();
                    r.Q6J("matMenuTriggerFor", e), r.xp6(3), r.Q6J("ngForOf", i.dayOptions);
                }
            }
            function pi(e, i) {
                if (
                    (1 & e &&
                        (r.TgZ(0, "div", 27),
                        r.TgZ(1, "div", 28),
                        r.TgZ(2, "span"),
                        r._uU(3),
                        r.ALo(4, "translate"),
                        r.qZA(),
                        r.TgZ(5, "span"),
                        r._uU(6),
                        r.ALo(7, "unixtime"),
                        r.qZA(),
                        r.qZA(),
                        r.TgZ(8, "div", 29),
                        r.TgZ(9, "span"),
                        r._uU(10),
                        r.ALo(11, "translate"),
                        r.qZA(),
                        r.TgZ(12, "span"),
                        r._uU(13),
                        r.ALo(14, "unixtime"),
                        r.qZA(),
                        r.qZA(),
                        r.qZA()),
                    2 & e)
                ) {
                    const e = r.oxw();
                    r.xp6(3), r.Oqu(r.lcZ(4, 4, "ls_first")), r.xp6(3), r.Oqu(r.lcZ(7, 6, e.firstArrivalTime)), r.xp6(4), r.Oqu(r.lcZ(11, 8, "ls_last")), r.xp6(3), r.Oqu(r.lcZ(14, 10, e.lastArrivalTime));
                }
            }
            function di(e, i) {
                if (
                    (1 & e &&
                        (r.TgZ(0, "div", 30),
                        r._UZ(1, "span", 31),
                        r.ALo(2, "safeHtml"),
                        r.ALo(3, "async"),
                        r.ALo(4, "asyncify"),
                        r.TgZ(5, "span", 32),
                        r._uU(6),
                        r.qZA(),
                        r.TgZ(7, "span", 33),
                        r._uU(8),
                        r.ALo(9, "unixtime"),
                        r.qZA(),
                        r.qZA()),
                    2 & e)
                ) {
                    const e = i.$implicit,
                        t = r.oxw();
                    r.ekj("future", t.isFuture(e.arrivalTime)), r.xp6(1), r.Q6J("innerHTML", r.lcZ(2, 5, r.lcZ(3, 7, r.lcZ(4, 9, t.lineImageHtml))), r.oJD), r.xp6(5), r.Oqu(e.lineDestination), r.xp6(2), r.Oqu(r.lcZ(9, 11, e.arrivalTime));
                }
            }
            const mi = (0, se.hu)("StopArrivalsComponent");
            let hi = (() => {
                class e {
                    constructor(e, i, t, n, a, o, s, l, r, c, p, d, m) {
                        (this.store = e),
                            (this.storeHelper = i),
                            (this.routingService = t),
                            (this.lineService = n),
                            (this.lineActions = a),
                            (this.analyticsService = o),
                            (this.canonicalService = s),
                            (this.el = l),
                            (this.translate = r),
                            (this.universal = c),
                            (this.a11y = p),
                            (this._cd = d),
                            (this.platformService = m),
                            (this.selectedDay = {}),
                            (this.completedInitialFocus = !1),
                            (this.stopArrivals = []),
                            (this.subscribes = []),
                            (this.trackByIndex = ei.z8);
                    }
                    ngOnInit() {
                        return (0, o.mG)(this, void 0, void 0, function* () {
                            if ((yield (0, l.p5)(this.store), this.state.metro.currentConditions.minimalData))
                                return mi.log("Metro with minimalData (community) detected, directing back to Line View"), void this.routingService.redirectToPreserveParams(this.canonicalService.buildStatefulPath([], P.zA.LINES_VIEW));
                            this.lineService.populateDayOptions(!0),
                                this.refreshFocus(),
                                this.subscribes.push(
                                    this.storeHelper.subscribe("global.isLoading", () => {
                                        this.state.global.isLoading || this.refreshFocus();
                                    })
                                ),
                                (this.stopArrivals = this.setStopArrivals()),
                                this.subscribes.push(
                                    this.storeHelper.subscribe("line", () => {
                                        this.stopArrivals = this.setStopArrivals();
                                    })
                                );
                        });
                    }
                    ngAfterViewChecked() {
                        !this.completedInitialFocus && this.backButton && this.a11y.byEnter && (this.backButton.nativeElement.focus(), (this.completedInitialFocus = !0));
                    }
                    ngOnDestroy() {
                        this.subscribes.forEach((e) => e());
                    }
                    get state() {
                        return this.store.getState();
                    }
                    get isLoading() {
                        return this.state.global.isLoading;
                    }
                    get emptyState() {
                        return this.state.global.appIsReady && !this.stopArrivals && this.universal.isBrowser;
                    }
                    get stop() {
                        return (this.state.line.displayedLine && this.state.line.displayedLine.stops[this.state.line.selectedStopIndex]) || {};
                    }
                    setStopArrivals() {
                        var e;
                        const { displayedLine: i, selectedStopIndex: t, selectedLine: n } = this.state.line;
                        if (!(null === (e = this.stop) || void 0 === e ? void 0 : e.id) || !(null == i ? void 0 : i.stopArrivals)) return null;
                        if (null == t || -1 === t || !(null == n ? void 0 : n.lineOptions)) return i.stopArrivals[this.stop.id];
                        const a = i.stops.map((e, i) => (e.id === this.stop.id ? i : null)).filter((e) => null !== e),
                            o = a.length,
                            s = 1 === a.length ? 0 : a.findIndex((e) => e === t);
                        let { lineOptions: l } = n;
                        o > 1 && (l.every((e) => e.stops.filter((e) => e.id === this.stop.id).length === o) || (l = l.filter((e) => e.patternId === i.patternId)));
                        const r = new Map();
                        return (
                            l.forEach((e) => {
                                let i = e.stopArrivals[this.stop.id];
                                if (i) {
                                    if (o > 1) {
                                        const t = e.stops.map((e, i) => (e.id === this.stop.id ? i : null)).filter((e) => null !== e)[s];
                                        i = i.filter((e) => e.stopIndex === t);
                                    }
                                    i.forEach((e) => {
                                        r.set(e.arrivalTime, e);
                                    });
                                }
                            }),
                            Array.from(r.values()).sort((e, i) => e.arrivalTime - i.arrivalTime)
                        );
                    }
                    get firstArrivalTime() {
                        return this.stopArrivals && this.stopArrivals.length && this.stopArrivals[0].arrivalTime;
                    }
                    get lastArrivalTime() {
                        return this.stopArrivals && this.stopArrivals.length && this.stopArrivals[this.stopArrivals.length - 1].arrivalTime;
                    }
                    get dayOptions() {
                        return this.lineService.dayOptions;
                    }
                    get lineImageHtml() {
                        return this.state.line.lineGroup.imageHtml;
                    }
                    refreshFocus() {
                        this.setSelectedDay(), this.scrollToRelevantArrival();
                    }
                    setSelectedDay() {
                        const e = (0, oe.ry)(this.state.line.selectedDayOffset);
                        this.selectedDay = this.dayOptions.find((i) => Number(i.value) === e) || this.dayOptions[0];
                    }
                    isFuture(e) {
                        return e > ue().unix();
                    }
                    goBack() {
                        return (0, o.mG)(this, void 0, void 0, function* () {
                            yield this.onDayChange(this.dayOptions[0]), this.routingService.updateUrlParams({ sid: null, sidx: null });
                        });
                    }
                    getDayDisplayText(e) {
                        return 0 === Number(e.value) ? this.translate.instant("today") : 1 === Number(e.value) ? this.translate.instant("tomorrow") : e.text;
                    }
                    onDayChange(e) {
                        return (0, o.mG)(this, void 0, void 0, function* () {
                            (this.selectedDay = e),
                                this.analyticsService.trackLinesAction("stop day change", { day: e.text }),
                                yield this.store.dispatch(this.lineActions.setStopArrivalsDay((0, oe.w3)(Number(e.value)))),
                                this.store.dispatch(this.lineActions.restoreStopFromUrl());
                        });
                    }
                    scrollToRelevantArrival() {
                        setTimeout(() => {
                            const e = this.el.nativeElement.querySelector(".future");
                            e && !this._cd.destroyed && document.querySelector("html").scrollTo(0, e.offsetTop - 130);
                        }, 500);
                    }
                }
                return (
                    (e.ɵfac = function (i) {
                        return new (i || e)(r.Y36(d.d), r.Y36(X.N), r.Y36(p.Z), r.Y36(pe.Z), r.Y36(c.J), r.Y36(h.y), r.Y36(f.z), r.Y36(r.SBq), r.Y36(k.sK), r.Y36(I.p), r.Y36(xe.F), r.Y36(r.sBO), r.Y36(g.mi));
                    }),
                    (e.ɵcmp = r.Xpm({
                        type: e,
                        selectors: [["mv-stop-arrivals"]],
                        viewQuery: function (e, i) {
                            if ((1 & e && (r.Gf(ni, 5), r.Gf(le.p6, 5), r.Gf(ai, 5, r.SBq)), 2 & e)) {
                                let e;
                                r.iGM((e = r.CRH())) && (i.backButton = e.first), r.iGM((e = r.CRH())) && (i.trigger = e.first), r.iGM((e = r.CRH())) && (i.futureArrivals = e);
                            }
                        },
                        decls: 26,
                        vars: 14,
                        consts: [
                            ["class", "empty-results", "role", "status", 4, "ngIf"],
                            [1, "stop-arrivals-header"],
                            [1, "line-group-header"],
                            ["tabindex", "0", 1, "back-link", 3, "click", "keydown.enter"],
                            ["backButton", ""],
                            ["role", "heading", "aria-level", "1", 1, "line-title"],
                            [1, "line-stop-container"],
                            [1, "line-stop-header"],
                            [1, "day-title"],
                            [1, "title"],
                            [1, "change-time"],
                            [4, "ngIf", "ngIfElse"],
                            ["desktopChangeTimeMenu", ""],
                            ["src", "images/icons/expand_white.svg", "mvAccessibleSVG", "", 3, "titleText"],
                            ["class", "firstLast", 4, "ngIf"],
                            ["role", "list", 1, "arrivals-list"],
                            ["class", "arrival-item", "role", "listitem", 3, "future", 4, "ngFor", "ngForOf", "ngForTrackBy"],
                            ["role", "status", 1, "empty-results"],
                            [1, "message"],
                            [3, "ngModel", "ngModelChange"],
                            [3, "ngValue", 4, "ngFor", "ngForOf"],
                            [3, "ngValue"],
                            [1, "overlay-selection", 3, "matMenuTriggerFor"],
                            ["tabindex", "0"],
                            ["optionsMenu", "matMenu"],
                            ["mat-menu-item", "", 3, "click", 4, "ngFor", "ngForOf"],
                            ["mat-menu-item", "", 3, "click"],
                            [1, "firstLast"],
                            [1, "firstInDay"],
                            [1, "lastInDay"],
                            ["role", "listitem", 1, "arrival-item"],
                            [1, "line-image", 3, "innerHTML"],
                            [1, "name"],
                            [1, "time"],
                        ],
                        template: function (e, i) {
                            if (
                                (1 & e &&
                                    (r.YNc(0, oi, 4, 3, "div", 0),
                                    r.TgZ(1, "div", 1),
                                    r.TgZ(2, "div", 2),
                                    r.TgZ(3, "a", 3, 4),
                                    r.NdJ("click", function () {
                                        return i.goBack();
                                    })("keydown.enter", function () {
                                        return i.goBack();
                                    }),
                                    r.qZA(),
                                    r.TgZ(5, "div"),
                                    r.TgZ(6, "span", 5),
                                    r._uU(7),
                                    r.qZA(),
                                    r.qZA(),
                                    r.qZA(),
                                    r.TgZ(8, "div", 6),
                                    r.TgZ(9, "div", 7),
                                    r.TgZ(10, "div", 8),
                                    r.TgZ(11, "span", 9),
                                    r.TgZ(12, "span"),
                                    r._uU(13),
                                    r.qZA(),
                                    r.qZA(),
                                    r.TgZ(14, "div", 10),
                                    r.YNc(15, li, 3, 2, "ng-container", 11),
                                    r.YNc(16, ci, 4, 2, "ng-template", null, 12, r.W1O),
                                    r.TgZ(18, "a"),
                                    r._uU(19),
                                    r.ALo(20, "translate"),
                                    r._UZ(21, "svg-icon", 13),
                                    r.ALo(22, "translate"),
                                    r.qZA(),
                                    r.qZA(),
                                    r.qZA(),
                                    r.YNc(23, pi, 15, 12, "div", 14),
                                    r.qZA(),
                                    r.qZA(),
                                    r.qZA(),
                                    r.TgZ(24, "div", 15),
                                    r.YNc(25, di, 10, 13, "div", 16),
                                    r.qZA()),
                                2 & e)
                            ) {
                                const e = r.MAs(17);
                                r.Q6J("ngIf", i.emptyState),
                                    r.xp6(7),
                                    r.Oqu(i.stop.name),
                                    r.xp6(6),
                                    r.Oqu(i.getDayDisplayText(i.selectedDay)),
                                    r.xp6(2),
                                    r.Q6J("ngIf", i.platformService.isMobile)("ngIfElse", e),
                                    r.xp6(4),
                                    r.hij(" ", r.lcZ(20, 10, "line_change_time"), " "),
                                    r.xp6(2),
                                    r.s9C("titleText", r.lcZ(22, 12, "line_change_time")),
                                    r.xp6(2),
                                    r.Q6J("ngIf", !i.emptyState),
                                    r.xp6(2),
                                    r.Q6J("ngForOf", i.stopArrivals)("ngForTrackBy", i.trackByIndex);
                            }
                        },
                        directives: [n.O5, b.bk, x.m, n.sg, y.EJ, y.JJ, y.On, y.YN, y.Kr, le.p6, le.VK, le.OP],
                        pipes: [k.X$, ii.T0, z.z, n.Ov, ti.N],
                        styles: [
                            "@-webkit-keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}@keyframes clickedEffect{0%{background-color:transparent}20%{background-color:#f5f7f7}to{background-color:transparent}}mv-stop-arrivals{display:flex;flex-direction:column;height:100%;overflow:hidden}mv-stop-arrivals .spinner{margin-top:50px;text-align:center;height:100%}mv-stop-arrivals .date-header{padding:5px 20px;background-color:#ecf0f1}mv-stop-arrivals .stop-arrivals-header{width:100%;z-index:1}html body.mobile mv-stop-arrivals .stop-arrivals-header{top:0px}html.privacy-notice body.mobile mv-stop-arrivals .stop-arrivals-header{top:calc(0px + 2.9411764706rem)}@media only screen and (max-width: 500px){html.privacy-notice body.mobile mv-stop-arrivals .stop-arrivals-header{top:calc(0px + 4.7058823529rem)}}html body[data-top-banner=true].mobile:not([class*=c_]) mv-stop-arrivals .stop-arrivals-header,body[data-top-banner=true].mobile[class*=c_4908] mv-stop-arrivals .stop-arrivals-header,body[data-top-banner=true].mobile[class*=c_4480] mv-stop-arrivals .stop-arrivals-header{top:calc(0px + 60px)}html.privacy-notice body.mobile[data-top-banner=true]:not([class*=c_]) mv-stop-arrivals .stop-arrivals-header,html.privacy-notice body[data-top-banner=true].mobile[class*=c_4908] mv-stop-arrivals .stop-arrivals-header,html.privacy-notice body[data-top-banner=true].mobile[class*=c_4480] mv-stop-arrivals .stop-arrivals-header{top:calc(0px + 60px + 2.9411764706rem)}@media only screen and (max-width: 500px){html.privacy-notice body.mobile[data-top-banner=true]:not([class*=c_]) mv-stop-arrivals .stop-arrivals-header,html.privacy-notice body[data-top-banner=true].mobile[class*=c_4908] mv-stop-arrivals .stop-arrivals-header,html.privacy-notice body[data-top-banner=true].mobile[class*=c_4480] mv-stop-arrivals .stop-arrivals-header{top:calc(0px + 60px + 4.7058823529rem)}}body.mobile mv-stop-arrivals .stop-arrivals-header{position:fixed}mv-stop-arrivals .line-group-header{box-sizing:border-box;min-height:54px;padding:15px 20px 13px;position:relative;font-size:.8235294118rem;background-color:#ecf0f1}html[dir=ltr] mv-stop-arrivals .line-group-header{padding-left:40px}html[dir=rtl] mv-stop-arrivals .line-group-header{padding-right:40px}mv-stop-arrivals .line-group-header>div{display:table;height:inherit;vertical-align:top}mv-stop-arrivals .line-group-header .line-image{display:table-cell}html[dir=ltr] mv-stop-arrivals .line-group-header .line-image{padding-right:15px}html[dir=rtl] mv-stop-arrivals .line-group-header .line-image{padding-left:15px}mv-stop-arrivals .line-group-header .line-image line-svg{margin:0}mv-stop-arrivals .line-group-header .line-title{display:table-cell;padding-top:5px;vertical-align:top;width:100%}mv-stop-arrivals .back-link{color:#292a30;height:100%;position:absolute;padding:0 16px;top:0;z-index:1}html[dir=ltr] mv-stop-arrivals .back-link{left:0}html[dir=rtl] mv-stop-arrivals .back-link{right:0}mv-stop-arrivals .back-link:focus{outline:none}mv-stop-arrivals .back-link:focus:before{outline:auto}mv-stop-arrivals .back-link:hover:before{outline:none}mv-stop-arrivals .back-link:before{content:url(/images/icons/arrow_gray.svg);display:block;position:relative;top:50%;width:7px;height:15px;padding:3px;transform:scaleX(-1) translateY(-50%)}html[dir=rtl] mv-stop-arrivals .back-link:before{transform:scale(1) translateY(-50%)}mv-stop-arrivals .line-stop-container .line-stop-header{box-sizing:border-box;display:table;padding:20px;background:#292A30;position:relative;width:100%}@media screen and (min-width: 500px){body.mobile.landscape mv-stop-arrivals .line-stop-container .line-stop-header{padding:10px 20px}}mv-stop-arrivals .line-stop-container .line-stop-header .day-title{display:table-cell;vertical-align:middle}@media screen and (min-width: 500px){body.mobile.landscape mv-stop-arrivals .line-stop-container .line-stop-header .day-title{display:flex}}mv-stop-arrivals .line-stop-container .line-stop-header .day-title .title{text-transform:capitalize;color:#fff;font-size:.9411764706rem}mv-stop-arrivals .line-stop-container .line-stop-header .change-time{padding:0;margin:0;font-size:.7058823529rem}@media screen and (min-width: 500px){body.mobile.landscape mv-stop-arrivals .line-stop-container .line-stop-header .change-time{margin:0 10px}}mv-stop-arrivals .line-stop-container .line-stop-header .change-time svg-icon{height:10px;width:10px}html[dir=ltr] mv-stop-arrivals .line-stop-container .line-stop-header .change-time svg-icon{margin-left:2px}html[dir=rtl] mv-stop-arrivals .line-stop-container .line-stop-header .change-time svg-icon{margin-right:2px}mv-stop-arrivals .line-stop-container .line-stop-header .change-time svg-icon .cls-1{fill:#0a93ff;transition:all .3s}mv-stop-arrivals .line-stop-container .line-stop-header .change-time select{position:absolute;opacity:0}mv-stop-arrivals .line-stop-container .line-stop-header .change-time select:focus+a{outline:auto}mv-stop-arrivals .line-stop-container .line-stop-header .change-time a{color:#0a93ff;display:inline-block;text-decoration:none;padding-top:4px;transition:all .3s}mv-stop-arrivals .line-stop-container .line-stop-header .change-time a:hover{color:#28adf7}mv-stop-arrivals .line-stop-container .line-stop-header .change-time a:hover .cls-1{fill:#28adf7}mv-stop-arrivals .line-stop-container .line-stop-header .firstLast{color:#fff;display:table-cell;vertical-align:middle}html[dir=ltr] mv-stop-arrivals .line-stop-container .line-stop-header .firstLast{text-align:right}html[dir=rtl] mv-stop-arrivals .line-stop-container .line-stop-header .firstLast{text-align:left}mv-stop-arrivals .line-stop-container .line-stop-header .firstLast span{display:block}mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .firstInDay{display:inline-block;text-align:left;text-align:initial}html[dir=ltr] mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .firstInDay{margin-right:20px}html[dir=rtl] mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .firstInDay{margin-left:20px}mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .firstInDay span:first-of-type{font-size:.7058823529rem}mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .lastInDay{display:inline-block}html[dir=ltr] mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .lastInDay{text-align:left}html[dir=rtl] mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .lastInDay{text-align:right}mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .lastInDay span:first-of-type{font-size:.7058823529rem}@media screen and (min-width: 500px){body.mobile.landscape mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .firstInDay,body.mobile.landscape mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .lastInDay{display:inline-flex}body.mobile.landscape mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .firstInDay>span:first-of-type,body.mobile.landscape mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .lastInDay>span:first-of-type{font-size:inherit}html[dir=ltr] body.mobile.landscape mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .firstInDay>span:first-of-type,html[dir=ltr] body.mobile.landscape mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .lastInDay>span:first-of-type{margin-right:5px}html[dir=rtl] body.mobile.landscape mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .firstInDay>span:first-of-type,html[dir=rtl] body.mobile.landscape mv-stop-arrivals .line-stop-container .line-stop-header .firstLast .lastInDay>span:first-of-type{margin-left:5px}}mv-stop-arrivals .destination-filter-container{padding:18px 20px;position:relative}mv-stop-arrivals .destination-filter-container .input-icon,mv-stop-arrivals .destination-filter-container .clear-icon{cursor:pointer;outline:none;position:absolute;top:calc(50% - 1px);transform:translateY(-50%)}html[dir=ltr] mv-stop-arrivals .destination-filter-container .input-icon,html[dir=ltr] mv-stop-arrivals .destination-filter-container .clear-icon{right:30px}html[dir=rtl] mv-stop-arrivals .destination-filter-container .input-icon,html[dir=rtl] mv-stop-arrivals .destination-filter-container .clear-icon{left:30px}mv-stop-arrivals .destination-filter-container .input-icon .icon,mv-stop-arrivals .destination-filter-container .clear-icon .icon{height:16px;width:16px}mv-stop-arrivals .destination-filter-container .input-icon .icon .cls-1,mv-stop-arrivals .destination-filter-container .clear-icon .icon .cls-1{fill:#737578}mv-stop-arrivals .destination-filter-container .button{padding:10px;background-color:#ecf0f1;color:#737578;border-radius:5px;cursor:pointer;outline:none}mv-stop-arrivals .arrivals-list{background:#fff;flex:1;overflow-y:auto}body.mobile mv-stop-arrivals .arrivals-list{margin-top:7.6470588235rem}@media screen and (min-width: 500px){body.mobile.landscape mv-stop-arrivals .arrivals-list{margin-top:5.8823529412rem}}mv-stop-arrivals .arrivals-list .arrival-item{box-sizing:border-box;display:table;min-height:40px;padding:14px 20px;position:relative;line-height:1.2;width:100%}mv-stop-arrivals .arrivals-list .arrival-item:last-child{margin-bottom:10px}mv-stop-arrivals .arrivals-list.passed{color:#bdc3c7}mv-stop-arrivals .line-image,mv-stop-arrivals .name,mv-stop-arrivals .time{display:table-cell;vertical-align:middle;width:1px}mv-stop-arrivals .time{font-weight:700;white-space:nowrap}mv-stop-arrivals .name{padding:0 8px;width:100%}mv-stop-arrivals .empty-results{text-align:center;padding:85px 20px 20px;position:absolute;top:50%}mv-stop-arrivals .empty-results .message{font-size:.9411764706rem;color:#737578;padding:20px}\n",
                        ],
                        encapsulation: 2,
                    })),
                    e
                );
            })();
            function vi(e, i) {
                1 & e && r._UZ(0, "mv-line-view");
            }
            function ui(e, i) {
                1 & e && r._UZ(0, "mv-stop-arrivals");
            }
            let gi = (() => {
                    class e {
                        constructor(e) {
                            (this.routingService = e), (this.SubTabId = P.zA);
                        }
                        ngOnInit() {
                            this.refreshRouteData(), this.routingService.onNavigationEnd(() => this.refreshRouteData());
                        }
                        refreshRouteData() {
                            this.routeData = this.routingService.getCurrentRouteData();
                        }
                    }
                    return (
                        (e.ɵfac = function (i) {
                            return new (i || e)(r.Y36(p.Z));
                        }),
                        (e.ɵcmp = r.Xpm({
                            type: e,
                            selectors: [["mv-line-router"]],
                            decls: 2,
                            vars: 2,
                            consts: [[4, "ngIf"]],
                            template: function (e, i) {
                                1 & e && (r.YNc(0, vi, 1, 0, "mv-line-view", 0), r.YNc(1, ui, 1, 0, "mv-stop-arrivals", 0)),
                                    2 & e &&
                                        (r.Q6J("ngIf", (null == i.routeData ? null : i.routeData.subTabId) === i.SubTabId.LINES_VIEW),
                                        r.xp6(1),
                                        r.Q6J("ngIf", (null == i.routeData ? null : i.routeData.subTabId) === i.SubTabId.LINES_STOPARRIVALS));
                            },
                            directives: [n.O5, We, hi],
                            encapsulation: 2,
                        })),
                        e
                    );
                })(),
                fi = (() => {
                    class e {
                        constructor(e) {
                            this.store = e;
                        }
                        resolve(e) {
                            const i = this.store.getState().metro.currentConditions.minimalData;
                            return (0, ei.kt)(e.queryParams.sid && !i ? P.zA.LINES_STOPARRIVALS : P.zA.LINES_VIEW);
                        }
                    }
                    return (
                        (e.ɵfac = function (i) {
                            return new (i || e)(r.LFG(d.d));
                        }),
                        (e.ɵprov = r.Yz7({ token: e, factory: e.ɵfac, providedIn: "root" })),
                        e
                    );
                })(),
                bi = (() => {
                    class e {
                        constructor(e) {
                            this.store = e;
                        }
                        resolve(e) {
                            const i = this.store.getState().metro.currentConditions.minimalData;
                            return (0, ei.kt)(!!e.queryParams.sid && !i);
                        }
                    }
                    return (
                        (e.ɵfac = function (i) {
                            return new (i || e)(r.LFG(d.d));
                        }),
                        (e.ɵprov = r.Yz7({ token: e, factory: e.ɵfac, providedIn: "root" })),
                        e
                    );
                })();
            var xi = t(39885);
            function yi(e) {
                return { path: e, resolve: { subTabId: fi, fullScreen: bi }, runGuardsAndResolvers: "paramsOrQueryParamsChange", component: gi };
            }
            const wi = [
                { path: ":lang", component: H, data: { subTabId: P.zA.LINES_MAIN } },
                yi(":lineShortName/:lineGroupId"),
                yi(":lineShortName/:lineGroupId/:lang"),
                yi(":lineShortName/:lineGroupId/:lineId/:lang"),
                { path: ":lineShortName/:lineGroupId/:lineId/map/:lang", component: ne, data: { subTabId: P.zA.LINES_MAP } },
                { path: "**", component: xi.H, data: { canonicalLanding: P.zA.LINES_MAIN } },
            ];
            let ki = (() => {
                class e {}
                return (
                    (e.ɵfac = function (i) {
                        return new (i || e)();
                    }),
                    (e.ɵmod = r.oAB({ type: e })),
                    (e.ɵinj = r.cJS({ imports: [[n.ez, y.u5, k.aw.forChild(), a.Bz.forChild(wi), _.Cl, $.m, b._J, le.Tx]] })),
                    e
                );
            })();
        },
        8967: function (e, i, t) {
            t.d(i, {
                d: function () {
                    return r;
                },
            });
            var n = t(3786),
                a = t(64852),
                o = t(99528),
                s = t(13127),
                l = t(44143);
            class r {
                constructor(e, i, t, n, o) {
                    (this.store = e),
                        (this.customerService = i),
                        (this.uiActions = t),
                        (this.icons = []),
                        (this.stopMarkers = []),
                        (this.nearbyStopsMarkers = []),
                        (this.nearbyDocklessVehiclesMarkers = []),
                        (this.nearbyBikesMarkers = []),
                        (this.nearbyElectricBikesMarkers = []),
                        (this.nearbyElectricScootersMarkers = []),
                        (this.nearbyKickScootersMarkers = []),
                        (this.nearbyMopedsMarkers = []),
                        (this.nearbyBikeStationsMarkers = []),
                        (this.nearbyDocklessCarsMarkers = []),
                        (this.mapElementId = n),
                        (this.logger = (0, a.hu)(o));
                }
                get state() {
                    return this.store.getState();
                }
                static loadLeafletPackage() {
                    var e;
                    return (0, n.mG)(this, void 0, void 0, function* () {
                        (null === (e = window.L) || void 0 === e ? void 0 : e.curve) ||
                            (yield t.e("default-node_modules_leaflet_dist_leaflet-src_js").then(t.t.bind(t, 20685, 23)),
                            yield t.e("node_modules_Leaflet_GeoJSON_Encoded_dist_leaflet_geojson_encoded_min_js").then(t.t.bind(t, 67470, 23)),
                            yield t.e("node_modules_leaflet-curve_leaflet_curve_js").then(t.t.bind(t, 95646, 23)));
                    });
                }
                initLeafletMap(e) {
                    var i;
                    return (0, n.mG)(this, void 0, void 0, function* () {
                        (null === (i = window.L) || void 0 === i ? void 0 : i.curve) || (this.store.dispatch(this.uiActions.setLoading(!0)), yield r.loadLeafletPackage(), this.store.dispatch(this.uiActions.setLoading(!1))),
                            (this.icons[o.$h.From] = L.icon({ iconUrl: this.customerService.getImagePath(this.state.customer.currentCustomer, "images/pin_from.svg"), iconSize: [23.33333, 28], iconAnchor: [11.666667, 28] })),
                            (this.icons[o.$h.To] = L.icon({ iconUrl: this.customerService.getImagePath(this.state.customer.currentCustomer, "images/pin_to.svg"), iconSize: [23.33333, 28], iconAnchor: [11.666667, 28] }));
                        const t = L.latLng(-89.98155760646617, -180),
                            n = L.latLng(89.99346179538875, 180),
                            a = L.latLngBounds(t, n);
                        (this.map = L.map(this.mapElementId, { zoomControl: !1, attributionControl: !1, minZoom: 4, maxBounds: a, maxBoundsViscosity: 1, touchZoom: !0, bounceAtZoomLimits: !1, keyboard: !1 })),
                            this.initCentralPoint(e),
                            this.initTileLayer(),
                            this.map.on("zoomend", (e) => {
                                if (this.stopMarkers) {
                                    const e = this.map.getZoom(),
                                        i = this.stopMarkers.length;
                                    this.stopMarkers.forEach((t) => {
                                        t = l.Gr(t, i, 12, e);
                                    });
                                }
                            }),
                            this.map.invalidateSize(),
                            setTimeout(() => this.map && this.map.invalidateSize(), 1e3);
                    });
                }
                initTileLayer() {
                    this.logger.log("initTileLayer");
                    const e = this.state.user.selectedMetro.tilesUrl,
                        i = e.includes("{z}/{x}/{y}") ? e : e.replace("http:", "https:") + "{z}/{x}/{y}.png";
                    L.tileLayer(i).addTo(this.map);
                    const t = L.control.attribution();
                    let n =
                        '<div>\xa9 <a data-google-interstitial="false" target="_blank" href="https://openmaptiles.org">OpenMapTiles</a></div><div>\xa9 <a target="_blank" data-google-interstitial="false" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors</div>';
                    if (i.startsWith("https://api.mapbox.com")) {
                        n =
                            '\xa9 <a data-google-interstitial="false" href="https://www.mapbox.com/about/maps/">Mapbox</a> \xa9 <a target="_blank" data-google-interstitial="false" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>\n        <strong><a data-google-interstitial="false" href="https://www.mapbox.com/map-feedback/" target="_blank">Improve this map</a></strong>';
                        const e = '<a data-google-interstitial="false" href="http://mapbox.com/about/maps" class=\'mapbox-wordmark\' target="_blank"></a>',
                            i = L.control.attribution();
                        i.setPosition("bottomleft"), i.setPrefix(e), i.addTo(this.map);
                    }
                    i.startsWith("https://api.maptiler.com") && (n = `\xa9 <a data-google-interstitial="false" target="_blank" href="https://maptiler.com/copyright/ ">MapTiler</a> ${n}`), t.setPrefix(n), t.addTo(this.map);
                }
                initCentralPoint(e) {
                    let i;
                    this.logger.log("initCentralPoint"),
                        (i = this.state.customer.currentCustomer && this.state.customer.currentCustomer.latLng ? this.state.customer.currentCustomer.latLng : s._.fromMvLatLon(this.state.metro.currentMetro.defaultLocation));
                    const t = e || 14;
                    this.logger.log("Initializing map with", { central: i, zoom: t }), this.map.setView(i, t);
                }
                fitBoundsByPoints(e) {
                    this.logger.log("fitBoundsByPoints");
                    const i = l.s1(e),
                        t = L.latLngBounds(i.southWest, i.northEast);
                    this.internalMapFitBounds(t);
                }
                internalMapFitBounds(e) {
                    const i = [0, 0],
                        t = [10, 10];
                    this.logger.log("Fitting to bounds", e, { paddingTopLeft: t, paddingBottomRight: i }), this.map.fitBounds(e, { paddingTopLeft: t, paddingBottomRight: i });
                }
                removeLayers(e) {
                    if (e && e.length > 0) for (const i of e) this.map.removeLayer(i);
                }
                addLayers(e) {
                    if (e && e.length > 0) for (const i of e) this.map.addLayer(i);
                }
                createStopMarkers(e, i, t, n = !0, a = !0, o = {}) {
                    this.logger.log("createStopMarkers");
                    const s = a ? l._p(n ? i.slice(1, -1) : i, t) : i;
                    for (const l of s) {
                        const i = [l.lat, l.lng],
                            t = L.divIcon({
                                className: "stop-div-icon",
                                html: '<div style="border-color:' + e + '"' + (l.stopIndex ? `id="stopIndex-${l.stopIndex}"` : "") + '"><div class="stop-clickable-zone stop-invisible"></div></div>',
                                iconSize: [12, 12],
                            }),
                            n = L.marker(i, Object.assign({ icon: t, title: l.stopName }, o)).addTo(this.map);
                        this.stopMarkers.push(n);
                    }
                }
                get isRTL() {
                    return !1;
                }
            }
        },
        38461: function (e, i, t) {
            t.d(i, {
                g: function () {
                    return h;
                },
            });
            var n = t(89679),
                a = t(58722),
                o = t(84608),
                s = t(3593),
                l = t(87272),
                r = t(75485),
                c = t(53399),
                p = t(19073);
            function d(e, i) {
                return i
                    ? (t) =>
                          (0, a.z)(
                              i.pipe(
                                  (0, o.q)(1),
                                  (0, s.e)((e, i) => {
                                      e.subscribe(new l.Q(i, r.Z));
                                  })
                              ),
                              t.pipe(d(e))
                          )
                    : (0 + 0, p.z)((i, t) =>
                          e(i, t).pipe(
                              (0, o.q)(1),
                              (function (e) {
                                  return (0, c.U)(() => e);
                              })(i)
                          )
                      );
            }
            var m = t(12336);
            function h(e, i = n.z) {
                const t = (0, m.H)(e, i);
                return d(() => t);
            }
        },
    },
]);
